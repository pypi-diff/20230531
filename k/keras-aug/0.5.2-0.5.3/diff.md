# Comparing `tmp/keras_aug-0.5.2-py3-none-any.whl.zip` & `tmp/keras_aug-0.5.3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,135 +1,140 @@
-Zip file size: 188763 bytes, number of entries: 133
--rw-r--r--  2.0 unx      373 b- defN 23-May-25 15:37 keras_aug/__init__.py
--rw-r--r--  2.0 unx      174 b- defN 23-May-25 15:37 keras_aug/conftest.py
--rw-r--r--  2.0 unx      572 b- defN 23-May-25 15:37 keras_aug/core/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/__init__.py
--rw-r--r--  2.0 unx      727 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/constant_factor_sampler.py
--rw-r--r--  2.0 unx      666 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/constant_factor_sampler_test.py
--rw-r--r--  2.0 unx      944 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/factor_sampler.py
--rw-r--r--  2.0 unx     1585 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/normal_factor_sampler.py
--rw-r--r--  2.0 unx      949 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/normal_factor_sampler_test.py
--rw-r--r--  2.0 unx     1666 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/signed_constant_factor_sampler.py
--rw-r--r--  2.0 unx      739 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/signed_constant_factor_sampler_test.py
--rw-r--r--  2.0 unx     2556 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/signed_normal_factor_sampler.py
--rw-r--r--  2.0 unx     1284 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/signed_normal_factor_sampler_test.py
--rw-r--r--  2.0 unx     1204 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/uniform_factor_sampler.py
--rw-r--r--  2.0 unx      778 b- defN 23-May-25 15:37 keras_aug/core/factor_sampler/uniform_factor_sampler_test.py
--rw-r--r--  2.0 unx     3641 b- defN 23-May-25 15:37 keras_aug/layers/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/__init__.py
--rw-r--r--  2.0 unx     2641 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/base_layer.py
--rw-r--r--  2.0 unx     1260 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/base_layer_test.py
--rw-r--r--  2.0 unx     7763 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/config_test.py
--rw-r--r--  2.0 unx    10731 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/graph_xla_mode_test.py
--rw-r--r--  2.0 unx    10954 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/mixed_precision_test.py
--rw-r--r--  2.0 unx    16428 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/output_common_test.py
--rw-r--r--  2.0 unx    11480 b- defN 23-May-25 15:37 keras_aug/layers/__internal__/with_ragged_image_test.py
--rw-r--r--  2.0 unx     2718 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/auto/__init__.py
--rw-r--r--  2.0 unx    12271 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/auto/aug_mix.py
--rw-r--r--  2.0 unx      815 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/auto/aug_mix_test.py
--rw-r--r--  2.0 unx    18413 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/auto/rand_augment.py
--rw-r--r--  2.0 unx     1281 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/auto/rand_augment_test.py
--rw-r--r--  2.0 unx    14525 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/auto/trivial_augment_wide.py
--rw-r--r--  2.0 unx      368 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/auto/trivial_augment_wide_test.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/__init__.py
--rw-r--r--  2.0 unx    23246 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_affine.py
--rw-r--r--  2.0 unx    15409 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_affine_test.py
--rw-r--r--  2.0 unx    12054 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_crop.py
--rw-r--r--  2.0 unx    11758 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_crop_and_resize.py
--rw-r--r--  2.0 unx     9817 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_crop_and_resize_test.py
--rw-r--r--  2.0 unx     7738 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_crop_test.py
--rw-r--r--  2.0 unx     7997 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_flip.py
--rw-r--r--  2.0 unx    11147 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_flip_test.py
--rw-r--r--  2.0 unx     7186 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_resize.py
--rw-r--r--  2.0 unx     8591 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_resize_test.py
--rw-r--r--  2.0 unx     9239 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_rotate.py
--rw-r--r--  2.0 unx     7395 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_rotate_test.py
--rw-r--r--  2.0 unx    12633 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_zoom_and_crop.py
--rw-r--r--  2.0 unx     6808 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/geometry/random_zoom_and_crop_test.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/__init__.py
--rw-r--r--  2.0 unx     3356 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/channel_shuffle.py
--rw-r--r--  2.0 unx     1633 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/channel_shuffle_test.py
--rw-r--r--  2.0 unx     4167 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_blur.py
--rw-r--r--  2.0 unx     1010 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_blur_test.py
--rw-r--r--  2.0 unx     3481 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_channel_shift.py
--rw-r--r--  2.0 unx     1506 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_channel_shift_test.py
--rw-r--r--  2.0 unx     9563 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_clahe.py
--rw-r--r--  2.0 unx     3093 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_clahe_test.py
--rw-r--r--  2.0 unx     9411 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_color_jitter.py
--rw-r--r--  2.0 unx     5660 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_color_jitter_test.py
--rw-r--r--  2.0 unx     3430 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_gamma.py
--rw-r--r--  2.0 unx     1420 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_gamma_test.py
--rw-r--r--  2.0 unx     5256 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_gaussian_blur.py
--rw-r--r--  2.0 unx     2098 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_gaussian_blur_test.py
--rw-r--r--  2.0 unx     7785 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_hsv.py
--rw-r--r--  2.0 unx     5230 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_hsv_test.py
--rw-r--r--  2.0 unx     4503 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_jpeg_quality.py
--rw-r--r--  2.0 unx     1155 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_jpeg_quality_test.py
--rw-r--r--  2.0 unx     4388 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_posterize.py
--rw-r--r--  2.0 unx     2768 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_posterize_test.py
--rw-r--r--  2.0 unx     5116 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_sharpness.py
--rw-r--r--  2.0 unx     1366 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_sharpness_test.py
--rw-r--r--  2.0 unx     5125 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_solarize.py
--rw-r--r--  2.0 unx     2269 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/intensity/random_solarize_test.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/mix/__init__.py
--rw-r--r--  2.0 unx     7143 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/mix/cut_mix.py
--rw-r--r--  2.0 unx     4258 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/mix/cut_mix_test.py
--rw-r--r--  2.0 unx     6149 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/mix/mix_up.py
--rw-r--r--  2.0 unx     2947 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/mix/mix_up_test.py
--rw-r--r--  2.0 unx    16288 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/mix/mosaic.py
--rw-r--r--  2.0 unx     2297 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/mix/mosaic_test.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/__init__.py
--rw-r--r--  2.0 unx     3737 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_channel_dropout.py
--rw-r--r--  2.0 unx      706 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_channel_dropout_test.py
--rw-r--r--  2.0 unx     9425 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_cutout.py
--rw-r--r--  2.0 unx     3189 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_cutout_test.py
--rw-r--r--  2.0 unx     7296 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_erase.py
--rw-r--r--  2.0 unx     3236 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_erase_test.py
--rw-r--r--  2.0 unx    10927 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_grid_mask.py
--rw-r--r--  2.0 unx     2161 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/regularization/random_grid_mask_test.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/utility/__init__.py
--rw-r--r--  2.0 unx     6080 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/utility/random_apply.py
--rw-r--r--  2.0 unx     2792 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/utility/random_apply_test.py
--rw-r--r--  2.0 unx     6457 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/utility/random_choice.py
--rw-r--r--  2.0 unx     2732 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/utility/random_choice_test.py
--rw-r--r--  2.0 unx     3588 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/utility/repeated_augment.py
--rw-r--r--  2.0 unx     1106 b- defN 23-May-25 15:37 keras_aug/layers/augmentation/utility/repeated_augment_test.py
--rw-r--r--  2.0 unx       98 b- defN 23-May-25 15:37 keras_aug/layers/base/__init__.py
--rw-r--r--  2.0 unx    24094 b- defN 23-May-25 15:37 keras_aug/layers/base/vectorized_base_random_layer.py
--rw-r--r--  2.0 unx    22086 b- defN 23-May-25 15:37 keras_aug/layers/base/vectorized_base_random_layer_test.py
--rw-r--r--  2.0 unx      825 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/geometry/__init__.py
--rw-r--r--  2.0 unx    10864 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/geometry/center_crop.py
--rw-r--r--  2.0 unx     8368 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/geometry/center_crop_test.py
--rw-r--r--  2.0 unx    10833 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/geometry/pad_if_needed.py
--rw-r--r--  2.0 unx     9878 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/geometry/pad_if_needed_test.py
--rw-r--r--  2.0 unx    15545 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/geometry/resize.py
--rw-r--r--  2.0 unx    22167 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/geometry/resize_test.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/__init__.py
--rw-r--r--  2.0 unx     2878 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/auto_contrast.py
--rw-r--r--  2.0 unx     2698 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/auto_contrast_test.py
--rw-r--r--  2.0 unx     4513 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/equalize.py
--rw-r--r--  2.0 unx     1529 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/equalize_test.py
--rw-r--r--  2.0 unx     2376 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/grayscale.py
--rw-r--r--  2.0 unx     1224 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/grayscale_test.py
--rw-r--r--  2.0 unx     1023 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/identity.py
--rw-r--r--  2.0 unx     1391 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/identity_test.py
--rw-r--r--  2.0 unx     1653 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/invert.py
--rw-r--r--  2.0 unx      459 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/invert_test.py
--rw-r--r--  2.0 unx     2931 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/normalize.py
--rw-r--r--  2.0 unx     1483 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/normalize_test.py
--rw-r--r--  2.0 unx     1923 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/rescale.py
--rw-r--r--  2.0 unx     1365 b- defN 23-May-25 15:37 keras_aug/layers/preprocessing/intensity/rescale_test.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-25 15:37 keras_aug/utils/__init__.py
--rw-r--r--  2.0 unx    18127 b- defN 23-May-25 15:37 keras_aug/utils/augmentation.py
--rw-r--r--  2.0 unx     7832 b- defN 23-May-25 15:37 keras_aug/utils/augmentation_test.py
--rw-r--r--  2.0 unx     8682 b- defN 23-May-25 15:37 keras_aug/utils/bounding_box.py
--rw-r--r--  2.0 unx     3235 b- defN 23-May-25 15:37 keras_aug/utils/bounding_box_test.py
--rw-r--r--  2.0 unx      373 b- defN 23-May-25 15:37 keras_aug/utils/conditional_imports.py
--rw-r--r--  2.0 unx     6101 b- defN 23-May-25 15:37 keras_aug/utils/demo.py
--rw-r--r--  2.0 unx    11456 b- defN 23-May-25 15:37 keras_aug-0.5.2.dist-info/LICENSE
--rw-r--r--  2.0 unx    13601 b- defN 23-May-25 15:37 keras_aug-0.5.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-25 15:37 keras_aug-0.5.2.dist-info/WHEEL
--rw-r--r--  2.0 unx       10 b- defN 23-May-25 15:37 keras_aug-0.5.2.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    14553 b- defN 23-May-25 15:37 keras_aug-0.5.2.dist-info/RECORD
-133 files, 714093 bytes uncompressed, 164521 bytes compressed:  77.0%
+Zip file size: 199046 bytes, number of entries: 138
+-rw-r--r--  2.0 unx      373 b- defN 23-May-31 07:58 keras_aug/__init__.py
+-rw-r--r--  2.0 unx      715 b- defN 23-May-31 07:58 keras_aug/conftest.py
+-rw-r--r--  2.0 unx      572 b- defN 23-May-31 07:58 keras_aug/core/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/__init__.py
+-rw-r--r--  2.0 unx      727 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/constant_factor_sampler.py
+-rw-r--r--  2.0 unx      666 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/constant_factor_sampler_test.py
+-rw-r--r--  2.0 unx      944 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/factor_sampler.py
+-rw-r--r--  2.0 unx     1585 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/normal_factor_sampler.py
+-rw-r--r--  2.0 unx      949 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/normal_factor_sampler_test.py
+-rw-r--r--  2.0 unx     1666 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/signed_constant_factor_sampler.py
+-rw-r--r--  2.0 unx      739 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/signed_constant_factor_sampler_test.py
+-rw-r--r--  2.0 unx     2556 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/signed_normal_factor_sampler.py
+-rw-r--r--  2.0 unx     1284 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/signed_normal_factor_sampler_test.py
+-rw-r--r--  2.0 unx     1204 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/uniform_factor_sampler.py
+-rw-r--r--  2.0 unx      778 b- defN 23-May-31 07:58 keras_aug/core/factor_sampler/uniform_factor_sampler_test.py
+-rw-r--r--  2.0 unx     3641 b- defN 23-May-31 07:58 keras_aug/layers/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/__init__.py
+-rw-r--r--  2.0 unx     2641 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/base_layer.py
+-rw-r--r--  2.0 unx     1260 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/base_layer_test.py
+-rw-r--r--  2.0 unx     7763 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/config_test.py
+-rw-r--r--  2.0 unx    10816 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/graph_xla_mode_test.py
+-rw-r--r--  2.0 unx    10954 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/mixed_precision_test.py
+-rw-r--r--  2.0 unx    16551 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/output_common_test.py
+-rw-r--r--  2.0 unx    10387 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/with_bounding_boxes_test.py
+-rw-r--r--  2.0 unx    11480 b- defN 23-May-31 07:58 keras_aug/layers/__internal__/with_ragged_image_test.py
+-rw-r--r--  2.0 unx     2718 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/auto/__init__.py
+-rw-r--r--  2.0 unx    12325 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/auto/aug_mix.py
+-rw-r--r--  2.0 unx      815 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/auto/aug_mix_test.py
+-rw-r--r--  2.0 unx    18859 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/auto/rand_augment.py
+-rw-r--r--  2.0 unx     1281 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/auto/rand_augment_test.py
+-rw-r--r--  2.0 unx    14971 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/auto/trivial_augment_wide.py
+-rw-r--r--  2.0 unx      368 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/auto/trivial_augment_wide_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/__init__.py
+-rw-r--r--  2.0 unx    23246 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_affine.py
+-rw-r--r--  2.0 unx    15409 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_affine_test.py
+-rw-r--r--  2.0 unx    12054 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_crop.py
+-rw-r--r--  2.0 unx    11758 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_crop_and_resize.py
+-rw-r--r--  2.0 unx    10996 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_crop_and_resize_test.py
+-rw-r--r--  2.0 unx     8659 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_crop_test.py
+-rw-r--r--  2.0 unx     7997 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_flip.py
+-rw-r--r--  2.0 unx    11147 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_flip_test.py
+-rw-r--r--  2.0 unx     7186 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_resize.py
+-rw-r--r--  2.0 unx     8591 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_resize_test.py
+-rw-r--r--  2.0 unx     9239 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_rotate.py
+-rw-r--r--  2.0 unx     7395 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_rotate_test.py
+-rw-r--r--  2.0 unx    12633 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_zoom_and_crop.py
+-rw-r--r--  2.0 unx     7787 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/geometry/random_zoom_and_crop_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/__init__.py
+-rw-r--r--  2.0 unx     3356 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/channel_shuffle.py
+-rw-r--r--  2.0 unx     1633 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/channel_shuffle_test.py
+-rw-r--r--  2.0 unx     4167 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_blur.py
+-rw-r--r--  2.0 unx     1010 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_blur_test.py
+-rw-r--r--  2.0 unx     3481 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_channel_shift.py
+-rw-r--r--  2.0 unx     1506 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_channel_shift_test.py
+-rw-r--r--  2.0 unx     9563 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_clahe.py
+-rw-r--r--  2.0 unx     3093 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_clahe_test.py
+-rw-r--r--  2.0 unx     9412 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_color_jitter.py
+-rw-r--r--  2.0 unx     5660 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_color_jitter_test.py
+-rw-r--r--  2.0 unx     3430 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_gamma.py
+-rw-r--r--  2.0 unx     1420 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_gamma_test.py
+-rw-r--r--  2.0 unx     5256 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_gaussian_blur.py
+-rw-r--r--  2.0 unx     2098 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_gaussian_blur_test.py
+-rw-r--r--  2.0 unx     7786 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_hsv.py
+-rw-r--r--  2.0 unx     5230 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_hsv_test.py
+-rw-r--r--  2.0 unx     4503 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_jpeg_quality.py
+-rw-r--r--  2.0 unx     1155 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_jpeg_quality_test.py
+-rw-r--r--  2.0 unx     4388 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_posterize.py
+-rw-r--r--  2.0 unx     2768 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_posterize_test.py
+-rw-r--r--  2.0 unx     5116 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_sharpness.py
+-rw-r--r--  2.0 unx     1366 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_sharpness_test.py
+-rw-r--r--  2.0 unx     5126 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_solarize.py
+-rw-r--r--  2.0 unx     2269 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/intensity/random_solarize_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/mix/__init__.py
+-rw-r--r--  2.0 unx     7139 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/mix/cut_mix.py
+-rw-r--r--  2.0 unx     4258 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/mix/cut_mix_test.py
+-rw-r--r--  2.0 unx     6145 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/mix/mix_up.py
+-rw-r--r--  2.0 unx     2947 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/mix/mix_up_test.py
+-rw-r--r--  2.0 unx    17535 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/mix/mosaic.py
+-rw-r--r--  2.0 unx     3801 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/mix/mosaic_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/__init__.py
+-rw-r--r--  2.0 unx     3737 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_channel_dropout.py
+-rw-r--r--  2.0 unx      706 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_channel_dropout_test.py
+-rw-r--r--  2.0 unx     9425 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_cutout.py
+-rw-r--r--  2.0 unx     3189 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_cutout_test.py
+-rw-r--r--  2.0 unx     7296 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_erase.py
+-rw-r--r--  2.0 unx     3236 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_erase_test.py
+-rw-r--r--  2.0 unx    10927 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_grid_mask.py
+-rw-r--r--  2.0 unx     2161 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/regularization/random_grid_mask_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/utility/__init__.py
+-rw-r--r--  2.0 unx     6555 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/utility/random_apply.py
+-rw-r--r--  2.0 unx     2792 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/utility/random_apply_test.py
+-rw-r--r--  2.0 unx     6932 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/utility/random_choice.py
+-rw-r--r--  2.0 unx     2732 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/utility/random_choice_test.py
+-rw-r--r--  2.0 unx     3588 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/utility/repeated_augment.py
+-rw-r--r--  2.0 unx     1106 b- defN 23-May-31 07:58 keras_aug/layers/augmentation/utility/repeated_augment_test.py
+-rw-r--r--  2.0 unx       98 b- defN 23-May-31 07:58 keras_aug/layers/base/__init__.py
+-rw-r--r--  2.0 unx    24269 b- defN 23-May-31 07:58 keras_aug/layers/base/vectorized_base_random_layer.py
+-rw-r--r--  2.0 unx    22094 b- defN 23-May-31 07:58 keras_aug/layers/base/vectorized_base_random_layer_test.py
+-rw-r--r--  2.0 unx      825 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/geometry/__init__.py
+-rw-r--r--  2.0 unx    11163 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/geometry/center_crop.py
+-rw-r--r--  2.0 unx     9365 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/geometry/center_crop_test.py
+-rw-r--r--  2.0 unx    10833 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/geometry/pad_if_needed.py
+-rw-r--r--  2.0 unx     9878 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/geometry/pad_if_needed_test.py
+-rw-r--r--  2.0 unx    15774 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/geometry/resize.py
+-rw-r--r--  2.0 unx    23160 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/geometry/resize_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/__init__.py
+-rw-r--r--  2.0 unx     2878 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/auto_contrast.py
+-rw-r--r--  2.0 unx     2698 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/auto_contrast_test.py
+-rw-r--r--  2.0 unx     4513 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/equalize.py
+-rw-r--r--  2.0 unx     1529 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/equalize_test.py
+-rw-r--r--  2.0 unx     2376 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/grayscale.py
+-rw-r--r--  2.0 unx     1224 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/grayscale_test.py
+-rw-r--r--  2.0 unx     1023 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/identity.py
+-rw-r--r--  2.0 unx     1391 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/identity_test.py
+-rw-r--r--  2.0 unx     1653 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/invert.py
+-rw-r--r--  2.0 unx      459 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/invert_test.py
+-rw-r--r--  2.0 unx     2932 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/normalize.py
+-rw-r--r--  2.0 unx     1483 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/normalize_test.py
+-rw-r--r--  2.0 unx     1923 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/rescale.py
+-rw-r--r--  2.0 unx     1365 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/intensity/rescale_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/utility/__init__.py
+-rw-r--r--  2.0 unx     3174 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/utility/sanitize_bounding_box.py
+-rw-r--r--  2.0 unx      996 b- defN 23-May-31 07:58 keras_aug/layers/preprocessing/utility/sanitize_bounding_box_test.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-31 07:58 keras_aug/utils/__init__.py
+-rw-r--r--  2.0 unx    18127 b- defN 23-May-31 07:58 keras_aug/utils/augmentation.py
+-rw-r--r--  2.0 unx     7832 b- defN 23-May-31 07:58 keras_aug/utils/augmentation_test.py
+-rw-r--r--  2.0 unx     8682 b- defN 23-May-31 07:58 keras_aug/utils/bounding_box.py
+-rw-r--r--  2.0 unx     3235 b- defN 23-May-31 07:58 keras_aug/utils/bounding_box_test.py
+-rw-r--r--  2.0 unx      373 b- defN 23-May-31 07:58 keras_aug/utils/conditional_imports.py
+-rw-r--r--  2.0 unx     6101 b- defN 23-May-31 07:58 keras_aug/utils/demo.py
+-rw-r--r--  2.0 unx      740 b- defN 23-May-31 07:58 keras_aug/utils/distribution.py
+-rw-r--r--  2.0 unx    11456 b- defN 23-May-31 07:58 keras_aug-0.5.3.dist-info/LICENSE
+-rw-r--r--  2.0 unx    26895 b- defN 23-May-31 07:58 keras_aug-0.5.3.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-31 07:58 keras_aug-0.5.3.dist-info/WHEEL
+-rw-r--r--  2.0 unx       10 b- defN 23-May-31 07:58 keras_aug-0.5.3.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    15104 b- defN 23-May-31 07:58 keras_aug-0.5.3.dist-info/RECORD
+138 files, 754407 bytes uncompressed, 173886 bytes compressed:  77.0%
```

## zipnote {}

```diff
@@ -63,14 +63,17 @@
 
 Filename: keras_aug/layers/__internal__/mixed_precision_test.py
 Comment: 
 
 Filename: keras_aug/layers/__internal__/output_common_test.py
 Comment: 
 
+Filename: keras_aug/layers/__internal__/with_bounding_boxes_test.py
+Comment: 
+
 Filename: keras_aug/layers/__internal__/with_ragged_image_test.py
 Comment: 
 
 Filename: keras_aug/layers/augmentation/__init__.py
 Comment: 
 
 Filename: keras_aug/layers/augmentation/auto/__init__.py
@@ -357,14 +360,23 @@
 
 Filename: keras_aug/layers/preprocessing/intensity/rescale.py
 Comment: 
 
 Filename: keras_aug/layers/preprocessing/intensity/rescale_test.py
 Comment: 
 
+Filename: keras_aug/layers/preprocessing/utility/__init__.py
+Comment: 
+
+Filename: keras_aug/layers/preprocessing/utility/sanitize_bounding_box.py
+Comment: 
+
+Filename: keras_aug/layers/preprocessing/utility/sanitize_bounding_box_test.py
+Comment: 
+
 Filename: keras_aug/utils/__init__.py
 Comment: 
 
 Filename: keras_aug/utils/augmentation.py
 Comment: 
 
 Filename: keras_aug/utils/augmentation_test.py
@@ -378,23 +390,26 @@
 
 Filename: keras_aug/utils/conditional_imports.py
 Comment: 
 
 Filename: keras_aug/utils/demo.py
 Comment: 
 
-Filename: keras_aug-0.5.2.dist-info/LICENSE
+Filename: keras_aug/utils/distribution.py
+Comment: 
+
+Filename: keras_aug-0.5.3.dist-info/LICENSE
 Comment: 
 
-Filename: keras_aug-0.5.2.dist-info/METADATA
+Filename: keras_aug-0.5.3.dist-info/METADATA
 Comment: 
 
-Filename: keras_aug-0.5.2.dist-info/WHEEL
+Filename: keras_aug-0.5.3.dist-info/WHEEL
 Comment: 
 
-Filename: keras_aug-0.5.2.dist-info/top_level.txt
+Filename: keras_aug-0.5.3.dist-info/top_level.txt
 Comment: 
 
-Filename: keras_aug-0.5.2.dist-info/RECORD
+Filename: keras_aug-0.5.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## keras_aug/__init__.py

```diff
@@ -3,8 +3,8 @@
 from keras_aug.core import ConstantFactorSampler
 from keras_aug.core import FactorSampler
 from keras_aug.core import NormalFactorSampler
 from keras_aug.core import SignedConstantFactorSampler
 from keras_aug.core import SignedNormalFactorSampler
 from keras_aug.core import UniformFactorSampler
 
-__version__ = "0.5.2"
+__version__ = "0.5.3"
```

## keras_aug/conftest.py

```diff
@@ -1,5 +1,27 @@
+import pytest
 import tensorflow as tf
 
-physical_devices = tf.config.list_physical_devices("GPU")
-for device in physical_devices:
-    tf.config.experimental.set_memory_growth(device, True)
+
+def pytest_configure():
+    physical_devices = tf.config.list_physical_devices("GPU")
+    for device in physical_devices:
+        tf.config.experimental.set_memory_growth(device, True)
+
+
+def pytest_addoption(parser):
+    parser.addoption(
+        "--skip-large",
+        action="store_true",
+        default=False,
+        help="skip large tests",
+    )
+
+
+def pytest_collection_modifyitems(config, items):
+    skip_large_tests = config.getoption("--skip-large")
+    skip_large = pytest.mark.skipif(
+        skip_large_tests, reason="need no --skip-large option to run"
+    )
+    for item in items:
+        if "large" in item.keywords:
+            item.add_marker(skip_large)
```

## keras_aug/layers/__internal__/graph_xla_mode_test.py

```diff
@@ -1,9 +1,10 @@
 import inspect
 
+import pytest
 import tensorflow as tf
 from absl.testing import parameterized
 
 from keras_aug import layers
 from keras_aug.layers import augmentation
 from keras_aug.layers import preprocessing
 from keras_aug.utils.augmentation import BOUNDING_BOXES
@@ -181,21 +182,21 @@
         },
         True,
     ),
     (
         "CutMix",
         layers.CutMix,
         {"alpha": 1.0},
-        True,
+        False,
     ),
     (
         "MixUp",
         layers.MixUp,
         {},
-        True,
+        False,
     ),
     (
         "Mosaic",
         layers.Mosaic,
         {
             "height": 100,
             "width": 100,
@@ -353,14 +354,15 @@
         bbox_names = set(item[0] for item in MUST_RUN_WITH_BOUNDING_BOXES)
         all_test_names = general_names.union(bbox_names)
 
         for name in all_2d_aug_layer_names:
             self.assertIn(name, all_test_names, msg=f"{name} not found")
 
     @parameterized.named_parameters(*GENERAL_TESTS)
+    @pytest.mark.large
     def test_run_in_graph_mode(self, layer_cls, args, is_xla_compatible):
         images = tf.random.uniform(shape=(2, 8, 8, 3)) * 255.0
         labels = tf.random.uniform(shape=(2, 1)) * 10.0
         bounding_boxes = {
             "boxes": tf.ragged.constant(
                 [
                     [[10, 10, 20, 20], [100, 100, 150, 150]],
@@ -383,28 +385,30 @@
 
         if has_bounding_boxes:
             fn({IMAGES: images, LABELS: labels, BOUNDING_BOXES: bounding_boxes})
         else:
             fn({IMAGES: images, LABELS: labels})
 
     @parameterized.named_parameters(*GENERAL_TESTS)
+    @pytest.mark.large
     def test_run_in_xla_mode(self, layer_cls, args, is_xla_compatible):
         if is_xla_compatible is False:
             return
         images = tf.random.uniform(shape=(1, 4, 4, 3)) * 255.0
         labels = tf.random.uniform(shape=(1, 1)) * 10.0
         layer = layer_cls(**args)
 
         @tf.function(jit_compile=True)
         def fn(inputs):
             layer(inputs)
 
         fn({IMAGES: images, LABELS: labels})
 
     @parameterized.named_parameters(*MUST_RUN_WITH_BOUNDING_BOXES)
+    @pytest.mark.large
     def test_run_in_graph_mode_bbox(self, layer_cls, args, is_xla_compatible):
         images = tf.random.uniform(shape=(2, 4, 4, 3)) * 255.0
         labels = tf.random.uniform(shape=(2, 1)) * 10.0
         bounding_boxes = {
             "boxes": tf.ragged.constant(
                 [
                     [[0, 0, 1, 1], [0, 0, 4, 4]],
```

## keras_aug/layers/__internal__/output_common_test.py

```diff
@@ -363,17 +363,20 @@
     layers.AugMix,
     layers.RandAugment,
     layers.TrivialAugmentWide,
     layers.RandomAffine,
     layers.RandomCrop,
     layers.RandomCropAndResize,
     layers.RandomRotate,
+    layers.CutMix,  # tf.random.stateless_gamma
+    layers.MixUp,  # tf.random.stateless_gamma
 ]
 
 NO_UINT8 = [
+    layers.AugMix,  # alpha
     layers.RandAugment,  # stateless_random_uniform
     layers.TrivialAugmentWide,  # stateless_random_uniform
     layers.RandomAffine,  # stateless_random_uniform
     layers.RandomCrop,  # stateless_random_uniform
     layers.RandomRotate,  # stateless_random_uniform
     layers.RandomZoomAndCrop,  # stateless_random_uniform
     layers.RandomSharpness,  # stateless_random_uniform
```

## keras_aug/layers/augmentation/auto/aug_mix.py

```diff
@@ -1,20 +1,21 @@
 import tensorflow as tf
-import tensorflow_probability as tfp
 from keras_cv.utils import preprocessing as preprocessing_utils
 from tensorflow import keras
 
 from keras_aug import layers
 from keras_aug.layers.base.vectorized_base_random_layer import (
     VectorizedBaseRandomLayer,
 )
 from keras_aug.utils import augmentation as augmentation_utils
 from keras_aug.utils.augmentation import H_AXIS
 from keras_aug.utils.augmentation import IMAGES
 from keras_aug.utils.augmentation import W_AXIS
+from keras_aug.utils.distribution import stateless_random_beta
+from keras_aug.utils.distribution import stateless_random_dirichlet
 
 
 @keras.utils.register_keras_serializable(package="keras_aug")
 class AugMix(VectorizedBaseRandomLayer):
     """Performs the AugMix data augmentation technique.
 
     AugMix aims to produce images with variety while preserving the image
@@ -71,46 +72,45 @@
         self.num_chains = num_chains
         if isinstance(chain_depth, int):
             chain_depth = [chain_depth, chain_depth]
         self.chain_depth = chain_depth
         self.alpha = alpha
         self.seed = seed
 
-        # distribution
-        self.beta_dist = tfp.distributions.Beta(self.alpha, self.alpha)
-        self.dirichlet_dist = tfp.distributions.Dirichlet(
-            tf.ones([self.num_chains]) * self.alpha
-        )
-
         # initialize layers
         self.auto_contrast = layers.AutoContrast(
             value_range=self.value_range, dtype=self.compute_dtype
         )
         self.equalize = layers.Equalize(
             value_range=self.value_range, dtype=self.compute_dtype
         )
 
     def get_random_transformation_batch(self, batch_size, **kwargs):
         # sample from dirichlet
-        seed = tf.cast(
-            self._random_generator.make_seed_for_stateless_op(), dtype=tf.int32
+        alpha = (
+            tf.ones([self.num_chains], dtype=self.compute_dtype) * self.alpha
         )
-        chain_mixing_weights = self.dirichlet_dist.sample(
-            (batch_size,), seed=seed
+        chain_mixing_weights = stateless_random_dirichlet(
+            (batch_size, self.num_chains),
+            seed=self._random_generator.make_seed_for_stateless_op(),
+            alpha=alpha,
+            dtype=self.compute_dtype,
         )
         # sample from beta
-        seed = tf.cast(
-            self._random_generator.make_seed_for_stateless_op(), dtype=tf.int32
+        weight_sample = stateless_random_beta(
+            (batch_size, 1),
+            seed_alpha=self._random_generator.make_seed_for_stateless_op(),
+            seed_beta=self._random_generator.make_seed_for_stateless_op(),
+            alpha=self.alpha,
+            beta=self.alpha,
+            dtype=self.compute_dtype,
         )
-        weight_sample = self.beta_dist.sample((batch_size, 1), seed=seed)
         return {
-            "chain_mixing_weights": tf.cast(
-                chain_mixing_weights, dtype=self.compute_dtype
-            ),
-            "weight_sample": tf.cast(weight_sample, dtype=self.compute_dtype),
+            "chain_mixing_weights": chain_mixing_weights,
+            "weight_sample": weight_sample,
         }
 
     def augment_ragged_image(self, image, transformation, **kwargs):
         images = tf.expand_dims(image, axis=0)
         transformations = augmentation_utils.expand_dict_dims(
             transformation, axis=0
         )
```

## keras_aug/layers/augmentation/auto/rand_augment.py

```diff
@@ -273,32 +273,40 @@
 
         # images value_range transform to [0, 255]
         images = preprocessing_utils.transform_value_range(
             images, self.value_range, (0, 255), dtype=self.compute_dtype
         )
         inputs[IMAGES] = images
 
+        bounding_boxes = inputs.get(BOUNDING_BOXES, None)
         # make bounding_boxes to dense first
-        if BOUNDING_BOXES in inputs:
-            inputs[BOUNDING_BOXES] = bounding_box.to_dense(
-                inputs[BOUNDING_BOXES]
-            )
+        if bounding_boxes is not None:
+            ori_bbox_info = bounding_box.validate_format(bounding_boxes)
+            inputs[BOUNDING_BOXES] = bounding_box.to_dense(bounding_boxes)
 
         inputs_for_rand_augment_single_input = {
             "inputs": inputs,
             "transformations": transformations,
         }
         result = tf.map_fn(
             self.rand_augment_single_input,
             inputs_for_rand_augment_single_input,
             fn_output_signature=augmentation_utils.compute_signature(
                 inputs, self.compute_dtype
             ),
         )
 
+        bounding_boxes = result.get(BOUNDING_BOXES, None)
+        if bounding_boxes is not None:
+            if ori_bbox_info["ragged"]:
+                bounding_boxes = bounding_box.to_ragged(bounding_boxes)
+            else:
+                bounding_boxes = bounding_box.to_dense(bounding_boxes)
+            result[BOUNDING_BOXES] = bounding_boxes
+
         # recover value_range
         images = result.get(IMAGES, None)
         images = preprocessing_utils.transform_value_range(
             images, (0, 255), self.value_range, self.compute_dtype
         )
         result[IMAGES] = images
         return result
```

## keras_aug/layers/augmentation/auto/trivial_augment_wide.py

```diff
@@ -264,32 +264,40 @@
 
         # images value_range transform to [0, 255]
         images = preprocessing_utils.transform_value_range(
             images, self.value_range, (0, 255), dtype=self.compute_dtype
         )
         inputs[IMAGES] = images
 
+        bounding_boxes = inputs.get(BOUNDING_BOXES, None)
         # make bounding_boxes to dense first
-        if BOUNDING_BOXES in inputs:
-            inputs[BOUNDING_BOXES] = bounding_box.to_dense(
-                inputs[BOUNDING_BOXES]
-            )
+        if bounding_boxes is not None:
+            ori_bbox_info = bounding_box.validate_format(bounding_boxes)
+            inputs[BOUNDING_BOXES] = bounding_box.to_dense(bounding_boxes)
 
         inputs_for_trivial_augment_single_input = {
             "inputs": inputs,
             "transformations": transformations,
         }
         result = tf.map_fn(
             self.trivial_augment_single_input,
             inputs_for_trivial_augment_single_input,
             fn_output_signature=augmentation_utils.compute_signature(
                 inputs, self.compute_dtype
             ),
         )
 
+        bounding_boxes = result.get(BOUNDING_BOXES, None)
+        if bounding_boxes is not None:
+            if ori_bbox_info["ragged"]:
+                bounding_boxes = bounding_box.to_ragged(bounding_boxes)
+            else:
+                bounding_boxes = bounding_box.to_dense(bounding_boxes)
+            result[BOUNDING_BOXES] = bounding_boxes
+
         # recover value_range
         images = result.get(IMAGES, None)
         images = preprocessing_utils.transform_value_range(
             images, (0, 255), self.value_range, self.compute_dtype
         )
         result[IMAGES] = images
         return result
```

## keras_aug/layers/augmentation/geometry/random_crop_and_resize_test.py

```diff
@@ -279,7 +279,41 @@
 
         result = layer(
             {"images": images, "segmentation_masks": segmentation_masks}
         )
 
         self.assertTrue(isinstance(result["segmentation_masks"], tf.Tensor))
         self.assertAllInSet(result["segmentation_masks"], tf.range(0, 10))
+
+    def test_ragged_input_with_graph_mode(self):
+        images = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 3), dtype=tf.float32),
+                tf.random.uniform((16, 8, 3), dtype=tf.float32),
+            ]
+        )
+        segmentation_masks = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((16, 8, 1), maxval=10, dtype=tf.int32),
+            ]
+        )
+        args = self.no_aug_args.copy()
+        args.update(
+            {
+                "height": 8,
+                "width": 8,
+                "aspect_ratio_factor": (0.5**2, 0.5**2),
+                "crop_area_factor": (1.0, 1.0),
+            }
+        )
+        layer = layers.RandomCropAndResize(**args)
+
+        @tf.function
+        def fn(inputs):
+            outputs = layer(inputs)
+            image_shape = outputs["images"].shape
+            segmentation_mask_shape = outputs["segmentation_masks"].shape
+            assert image_shape == (2, 8, 8, 3)
+            assert segmentation_mask_shape == (2, 8, 8, 1)
+
+        fn({"images": images, "segmentation_masks": segmentation_masks})
```

## keras_aug/layers/augmentation/geometry/random_crop_test.py

```diff
@@ -196,7 +196,32 @@
         result = layer(
             {"images": images, "segmentation_masks": segmentation_masks}
         )
 
         self.assertTrue(isinstance(result["segmentation_masks"], tf.Tensor))
         self.assertEqual(result["segmentation_masks"].shape[1:3], (2, 2))
         self.assertAllInSet(result["segmentation_masks"], tf.range(0, 10))
+
+    def test_ragged_input_with_graph_mode(self):
+        images = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 3), dtype=tf.float32),
+                tf.random.uniform((16, 8, 3), dtype=tf.float32),
+            ]
+        )
+        segmentation_masks = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((16, 8, 1), maxval=10, dtype=tf.int32),
+            ]
+        )
+        layer = layers.RandomCrop(height=8, width=8)
+
+        @tf.function
+        def fn(inputs):
+            outputs = layer(inputs)
+            image_shape = outputs["images"].shape
+            segmentation_mask_shape = outputs["segmentation_masks"].shape
+            assert image_shape == (2, 8, 8, 3)
+            assert segmentation_mask_shape == (2, 8, 8, 1)
+
+        fn({"images": images, "segmentation_masks": segmentation_masks})
```

## keras_aug/layers/augmentation/geometry/random_zoom_and_crop_test.py

```diff
@@ -199,7 +199,34 @@
         )
 
         self.assertTrue(isinstance(result["segmentation_masks"], tf.Tensor))
         self.assertEqual(
             result["segmentation_masks"].shape[1:3], (self.height, self.width)
         )
         self.assertAllInSet(result["segmentation_masks"], tf.range(0, 10))
+
+    def test_ragged_input_with_graph_mode(self):
+        images = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 3), dtype=tf.float32),
+                tf.random.uniform((16, 8, 3), dtype=tf.float32),
+            ]
+        )
+        segmentation_masks = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((16, 8, 1), maxval=10, dtype=tf.int32),
+            ]
+        )
+        layer = layers.RandomZoomAndCrop(
+            height=8, width=8, scale_factor=(3 / 4, 4 / 3)
+        )
+
+        @tf.function
+        def fn(inputs):
+            outputs = layer(inputs)
+            image_shape = outputs["images"].shape
+            segmentation_mask_shape = outputs["segmentation_masks"].shape
+            assert image_shape == (2, 8, 8, 3)
+            assert segmentation_mask_shape == (2, 8, 8, 1)
+
+        fn({"images": images, "segmentation_masks": segmentation_masks})
```

## keras_aug/layers/augmentation/intensity/random_color_jitter.py

```diff
@@ -52,15 +52,15 @@
         self,
         value_range,
         brightness_factor=None,
         contrast_factor=None,
         saturation_factor=None,
         hue_factor=None,
         seed=None,
-        **kwargs
+        **kwargs,
     ):
         super().__init__(seed=seed, **kwargs)
         self.brightness_factor = None
         self.contrast_factor = None
         self.saturation_factor = None
         self.hue_factor = None
         if brightness_factor:
```

## keras_aug/layers/augmentation/intensity/random_hsv.py

```diff
@@ -50,15 +50,15 @@
     def __init__(
         self,
         value_range,
         hue_factor=None,
         saturation_factor=None,
         value_factor=None,
         seed=None,
-        **kwargs
+        **kwargs,
     ):
         super().__init__(seed=seed, **kwargs)
         self.hue_factor = None
         self.saturation_factor = None
         self.value_factor = None
         if hue_factor is not None:
             self.hue_factor = augmentation_utils.parse_factor(
```

## keras_aug/layers/augmentation/intensity/random_solarize.py

```diff
@@ -43,15 +43,15 @@
 
     def __init__(
         self,
         value_range,
         threshold_factor,
         addition_factor=0,
         seed=None,
-        **kwargs
+        **kwargs,
     ):
         super().__init__(seed=seed, **kwargs)
         self.value_range = value_range
         if isinstance(threshold_factor, (int, float)):
             threshold_factor = (0, threshold_factor)
         self.threshold_factor = augmentation_utils.parse_factor(
             threshold_factor,
```

## keras_aug/layers/augmentation/mix/cut_mix.py

```diff
@@ -1,20 +1,20 @@
 import tensorflow as tf
-import tensorflow_probability as tfp
 from keras_cv.utils import fill_utils
 from tensorflow import keras
 
 from keras_aug.layers.base.vectorized_base_random_layer import (
     VectorizedBaseRandomLayer,
 )
 from keras_aug.utils.augmentation import BATCHED
 from keras_aug.utils.augmentation import H_AXIS
 from keras_aug.utils.augmentation import LABELS
 from keras_aug.utils.augmentation import SEGMENTATION_MASKS
 from keras_aug.utils.augmentation import W_AXIS
+from keras_aug.utils.distribution import stateless_random_beta
 
 
 @keras.utils.register_keras_serializable(package="keras_aug")
 class CutMix(VectorizedBaseRandomLayer):
     """CutMix implements the CutMix data augmentation technique.
 
     CutMix only supports dense images as inputs.
@@ -38,17 +38,14 @@
         seed=None,
         **kwargs,
     ):
         super().__init__(seed=seed, **kwargs)
         self.alpha = alpha
         self.seed = seed
 
-        # beta distribution
-        self.beta_dist = tfp.distributions.Beta(self.alpha, self.alpha)
-
         # set force_no_unwrap_ragged_image_call=True because CutMix needs
         # to process images in batch.
         self.force_no_unwrap_ragged_image_call = True
 
     def get_random_transformation_batch(
         self, batch_size, images=None, **kwargs
     ):
@@ -56,19 +53,22 @@
         width = tf.cast(tf.shape(images)[W_AXIS], dtype=self.compute_dtype)
         permutation_order = self._random_generator.random_uniform(
             (batch_size,),
             minval=0,
             maxval=batch_size,
             dtype=tf.int32,
         )
-        seed = tf.cast(
-            self._random_generator.make_seed_for_stateless_op(), dtype=tf.int32
+        lambda_samples = stateless_random_beta(
+            (batch_size,),
+            seed_alpha=self._random_generator.make_seed_for_stateless_op(),
+            seed_beta=self._random_generator.make_seed_for_stateless_op(),
+            alpha=self.alpha,
+            beta=self.alpha,
+            dtype=self.compute_dtype,
         )
-        lambda_samples = self.beta_dist.sample((batch_size,), seed=seed)
-        lambda_samples = tf.cast(lambda_samples, dtype=self.compute_dtype)
         ratios = tf.math.sqrt(1.0 - lambda_samples)
         height = tf.cast(tf.shape(images)[H_AXIS], dtype=self.compute_dtype)
         width = tf.cast(tf.shape(images)[W_AXIS], dtype=self.compute_dtype)
         cut_heights = tf.cast(ratios * height, dtype=tf.int32)
         cut_widths = tf.cast(ratios * width, dtype=tf.int32)
         center_xs = self._random_generator.random_uniform(
             shape=(batch_size,), dtype=self.compute_dtype
```

## keras_aug/layers/augmentation/mix/mix_up.py

```diff
@@ -1,16 +1,16 @@
 import tensorflow as tf
-import tensorflow_probability as tfp
 from keras_cv import bounding_box
 from tensorflow import keras
 
 from keras_aug.layers.base.vectorized_base_random_layer import (
     VectorizedBaseRandomLayer,
 )
 from keras_aug.utils.augmentation import BATCHED
+from keras_aug.utils.distribution import stateless_random_beta
 
 
 @keras.utils.register_keras_serializable(package="keras_aug")
 class MixUp(VectorizedBaseRandomLayer):
     """The MixUp data augmentation technique.
 
     The MixUp data augmentation technique involves taking 2 images from a given
@@ -35,30 +35,30 @@
     """  # noqa: E501
 
     def __init__(self, alpha=0.2, seed=None, **kwargs):
         super().__init__(seed=seed, **kwargs)
         self.alpha = alpha
         self.seed = seed
 
-        # beta distribution
-        self.beta_dist = tfp.distributions.Beta(self.alpha, self.alpha)
-
         # set force_no_unwrap_ragged_image_call=True because MixUp needs
         # to process images in batch.
         self.force_no_unwrap_ragged_image_call = True
 
     def get_random_transformation_batch(self, batch_size, **kwargs):
         permutation_order = tf.argsort(
             self._random_generator.random_uniform((batch_size,)), axis=-1
         )
-        seed = tf.cast(
-            self._random_generator.make_seed_for_stateless_op(), dtype=tf.int32
+        lambda_samples = stateless_random_beta(
+            (batch_size, 1, 1, 1),
+            seed_alpha=self._random_generator.make_seed_for_stateless_op(),
+            seed_beta=self._random_generator.make_seed_for_stateless_op(),
+            alpha=self.alpha,
+            beta=self.alpha,
+            dtype=self.compute_dtype,
         )
-        lambda_samples = self.beta_dist.sample((batch_size, 1, 1, 1), seed=seed)
-        lambda_samples = tf.cast(lambda_samples, dtype=self.compute_dtype)
         return {
             "permutation_order": permutation_order,
             "lambda_samples": lambda_samples,
         }
 
     def augment_images(self, images, transformations, **kwargs):
         if isinstance(images, tf.RaggedTensor):
```

## keras_aug/layers/augmentation/mix/mosaic.py

```diff
@@ -7,14 +7,15 @@
 )
 from keras_aug.utils import augmentation as augmentation_utils
 from keras_aug.utils import bounding_box as bounding_box_utils
 from keras_aug.utils.augmentation import BATCHED
 from keras_aug.utils.augmentation import BOUNDING_BOXES
 from keras_aug.utils.augmentation import IMAGES
 from keras_aug.utils.augmentation import LABELS
+from keras_aug.utils.augmentation import SEGMENTATION_MASKS
 
 
 @keras.utils.register_keras_serializable(package="keras_aug")
 class Mosaic(VectorizedBaseRandomLayer):
     """The Mosaic data augmentation technique used by YOLO series.
 
     The Mosaic data augmentation first takes 4 images from the batch and makes a
@@ -109,27 +110,29 @@
 
         return {
             "permutation_order": permutation_order,
             "mosaic_centers": mosaic_centers,
         }
 
     def augment_images(self, images, transformations, **kwargs):
+        ori_shape = images.shape
         permutation_order = transformations["permutation_order"]
         mosaic_images = tf.gather(images, permutation_order)
         inputs_for_pad_and_mosaic_single_image = {
             "transformations": transformations,
             IMAGES: mosaic_images,
         }
         images = tf.map_fn(
             self.get_mosaic_single_image,
             inputs_for_pad_and_mosaic_single_image,
             fn_output_signature=self.compute_dtype,
         )
         images = tf.ensure_shape(
-            images, shape=(None, self.height, self.width, None)
+            images,
+            shape=(ori_shape[0], self.height, self.width, ori_shape[-1]),
         )
         return images
 
     def augment_labels(self, labels, transformations, images=None, **kwargs):
         is_ragged_labels = isinstance(labels, tf.RaggedTensor)
         if is_ragged_labels:
             labels = labels.to_tensor()
@@ -243,14 +246,37 @@
             source="xyxy",
             target=self.bounding_box_format,
             image_shape=(self.height, self.width, None),
             dtype=self.compute_dtype,
         )
         return boxes_for_mosaic
 
+    def augment_segmentation_masks(
+        self, segmentation_masks, transformations, **kwargs
+    ):
+        ori_shape = segmentation_masks.shape
+        permutation_order = transformations["permutation_order"]
+        mosaic_segmentation_masks = tf.gather(
+            segmentation_masks, permutation_order
+        )
+        inputs_for_pad_and_mosaic_single_image = {
+            "transformations": transformations,
+            IMAGES: mosaic_segmentation_masks,
+        }
+        mosaic_segmentation_masks = tf.map_fn(
+            self.get_mosaic_single_image,
+            inputs_for_pad_and_mosaic_single_image,
+            fn_output_signature=self.compute_dtype,
+        )
+        mosaic_segmentation_masks = tf.ensure_shape(
+            mosaic_segmentation_masks,
+            shape=(ori_shape[0], self.height, self.width, ori_shape[-1]),
+        )
+        return mosaic_segmentation_masks
+
     def _batch_augment(self, inputs):
         self._validate_inputs(inputs)
         return super()._batch_augment(inputs)
 
     def call(self, inputs):
         _, metadata = self._format_inputs(inputs)
         if metadata[BATCHED] is not True:
@@ -262,19 +288,25 @@
             )
         return super().call(inputs=inputs)
 
     def _validate_inputs(self, inputs):
         images = inputs.get(IMAGES, None)
         labels = inputs.get(LABELS, None)
         bounding_boxes = inputs.get(BOUNDING_BOXES, None)
-        if images is None or (labels is None and bounding_boxes is None):
+        segmentation_masks = inputs.get(SEGMENTATION_MASKS, None)
+        if images is None or (
+            labels is None
+            and bounding_boxes is None
+            and segmentation_masks is None
+        ):
             raise ValueError(
                 "Mosaic expects inputs in a dictionary with format "
-                '{"images": images, "labels": labels}. or'
-                '{"images": images, "bounding_boxes": bounding_boxes}'
+                '{"images": images, "labels": labels}. or '
+                '{"images": images, "bounding_boxes": bounding_boxes} or '
+                '{"images": images, "segmentation_masks": segmentation_masks}'
                 f"Got: inputs = {inputs}"
             )
         if bounding_boxes is not None and self.bounding_box_format is None:
             raise ValueError(
                 "Mosaic received bounding boxes but no "
                 "bounding_box_format. Please pass a bounding_box_format from "
                 "the supported list."
```

## keras_aug/layers/augmentation/mix/mosaic_test.py

```diff
@@ -31,16 +31,16 @@
             outputs["images"],
             outputs["labels"],
             outputs["bounding_boxes"],
         )
 
         self.assertEqual(xs.shape, [2, 32, 32, 3])
         self.assertEqual(ys_labels.shape, [2, 10])
-        self.assertEqual(ys_bounding_boxes["boxes"].shape, [2, None, 4])
-        self.assertEqual(ys_bounding_boxes["classes"].shape, [2, None])
+        self.assertEqual(ys_bounding_boxes["boxes"].shape, [2, 3 * 4, 4])
+        self.assertEqual(ys_bounding_boxes["classes"].shape, [2, 3 * 4])
 
     def test_image_input_only(self):
         xs = tf.cast(
             tf.stack([2 * tf.ones((10, 10, 1)), tf.ones((10, 10, 1))], axis=0),
             tf.float32,
         )
         layer = layers.Mosaic(height=32, width=32)
@@ -64,7 +64,46 @@
         xs = tf.ones((2, 32, 32, 3))
         layer = layers.Mosaic(height=32, width=32)
         with self.assertRaisesRegexp(
             ValueError,
             "Mosaic expects inputs in a dictionary with format",
         ):
             _ = layer(xs)
+
+    def test_ragged_input_with_graph_mode(self):
+        images = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 3), dtype=tf.float32),
+                tf.random.uniform((16, 8, 3), dtype=tf.float32),
+                tf.random.uniform((8, 8, 3), dtype=tf.float32),
+                tf.random.uniform((16, 8, 3), dtype=tf.float32),
+            ]
+        )
+        # randomly sample labels
+        labels = tf.random.categorical(tf.math.log([[0.5, 0.5, 0.5, 0.5]]), 2)
+        labels = tf.squeeze(labels)
+        labels = tf.one_hot(labels, 10)
+        segmentation_masks = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((16, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((8, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((16, 8, 1), maxval=10, dtype=tf.int32),
+            ]
+        )
+        layer = layers.Mosaic(height=8, width=8)
+
+        @tf.function
+        def fn(inputs):
+            outputs = layer(inputs)
+            image_shape = outputs["images"].shape
+            segmentation_mask_shape = outputs["segmentation_masks"].shape
+            self.assertEqual(image_shape, (4, 8, 8, 3))
+            self.assertEqual(segmentation_mask_shape, (4, 8, 8, 1))
+
+        fn(
+            {
+                "images": images,
+                "labels": labels,
+                "segmentation_masks": segmentation_masks,
+            }
+        )
```

## keras_aug/layers/augmentation/utility/random_apply.py

```diff
@@ -111,25 +111,34 @@
     def _batch_augment(self, inputs):
         images = inputs.get(IMAGES, None)
         batch_size = tf.shape(images)[0]
         probs = self.get_random_transformation_batch(batch_size)
         if self.batchwise:
             result = self.layer(inputs) if probs[0] < self.rate else inputs
         else:
+            bounding_boxes = inputs.get(BOUNDING_BOXES, None)
             # make bounding_boxes to dense first
-            if BOUNDING_BOXES in inputs:
-                inputs[BOUNDING_BOXES] = bounding_box.to_dense(
-                    inputs[BOUNDING_BOXES]
-                )
+            if bounding_boxes is not None:
+                ori_bbox_info = bounding_box.validate_format(bounding_boxes)
+                inputs[BOUNDING_BOXES] = bounding_box.to_dense(bounding_boxes)
+
             inputs_for_augment = {"inputs": inputs, "probs": probs}
             result = tf.map_fn(
                 self.augment,
                 inputs_for_augment,
                 fn_output_signature=self.compute_inputs_signature(inputs),
             )
+
+            bounding_boxes = result.get(BOUNDING_BOXES, None)
+            if bounding_boxes is not None:
+                if ori_bbox_info["ragged"]:
+                    bounding_boxes = bounding_box.to_ragged(bounding_boxes)
+                else:
+                    bounding_boxes = bounding_box.to_dense(bounding_boxes)
+                result[BOUNDING_BOXES] = bounding_boxes
         return result
 
     def augment(self, inputs):
         input = inputs.get("inputs", None)
         prob = inputs.get("probs", None)
         if prob < self.rate:
             result = self.layer(input)
```

## keras_aug/layers/augmentation/utility/random_choice.py

```diff
@@ -116,28 +116,37 @@
         transformations = self.get_random_transformation_batch(batch_size)
         if self.batchwise:
             selected_op_idx = transformations[0]
             result = self.augment(
                 {"inputs": inputs, "transformations": selected_op_idx}
             )
         else:
+            bounding_boxes = inputs.get(BOUNDING_BOXES, None)
             # make bounding_boxes to dense first
-            if BOUNDING_BOXES in inputs:
-                inputs[BOUNDING_BOXES] = bounding_box.to_dense(
-                    inputs[BOUNDING_BOXES]
-                )
+            if bounding_boxes is not None:
+                ori_bbox_info = bounding_box.validate_format(bounding_boxes)
+                inputs[BOUNDING_BOXES] = bounding_box.to_dense(bounding_boxes)
+
             inputs_for_random_choice_single_input = {
                 "inputs": inputs,
                 "transformations": transformations,
             }
             result = tf.map_fn(
                 self.augment,
                 inputs_for_random_choice_single_input,
                 fn_output_signature=self.compute_inputs_signature(inputs),
             )
+
+            bounding_boxes = result.get(BOUNDING_BOXES, None)
+            if bounding_boxes is not None:
+                if ori_bbox_info["ragged"]:
+                    bounding_boxes = bounding_box.to_ragged(bounding_boxes)
+                else:
+                    bounding_boxes = bounding_box.to_dense(bounding_boxes)
+                result[BOUNDING_BOXES] = bounding_boxes
         return result
 
     def augment(self, inputs):
         input = inputs.get("inputs")
         selected_op_idx = inputs.get("transformations")
         # construct branch_fns
         branch_fns = {}
```

## keras_aug/layers/base/vectorized_base_random_layer.py

```diff
@@ -433,24 +433,28 @@
                 bounding_boxes=bounding_boxes,
                 images=images,
                 raw_images=raw_images,
             )
             result[LABELS] = labels
 
         if bounding_boxes is not None:
+            ori_bounding_boxes_info = bounding_box.validate_format(
+                bounding_boxes
+            )
             bounding_boxes = self.augment_bounding_boxes(
                 bounding_boxes,
                 transformations=transformations,
                 labels=labels,
                 images=images,
                 raw_images=raw_images,
             )
-            bounding_boxes = bounding_box.to_ragged(
-                bounding_boxes, dtype=self.compute_dtype
-            )
+            if ori_bounding_boxes_info["ragged"]:
+                bounding_boxes = bounding_box.to_ragged(
+                    bounding_boxes, dtype=self.compute_dtype
+                )
             result[BOUNDING_BOXES] = bounding_boxes
 
         if keypoints is not None:
             keypoints = self.augment_keypoints(
                 keypoints,
                 transformations=transformations,
                 labels=labels,
```

## keras_aug/layers/base/vectorized_base_random_layer_test.py

```diff
@@ -60,15 +60,15 @@
         self,
         batch_size,
         images=None,
         labels=None,
         bounding_boxes=None,
         keypoints=None,
         segmentation_masks=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(images, TF_ALL_TENSOR_TYPES)
         assert isinstance(labels, TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(keypoints, TF_ALL_TENSOR_TYPES)
         assert isinstance(segmentation_masks, TF_ALL_TENSOR_TYPES)
@@ -78,15 +78,15 @@
         self,
         image,
         label=None,
         bounding_boxes=None,
         keypoints=None,
         segmentation_mask=None,
         transformation=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(image, TF_ALL_TENSOR_TYPES)
         assert isinstance(label, TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(keypoints, TF_ALL_TENSOR_TYPES)
         assert isinstance(segmentation_mask, TF_ALL_TENSOR_TYPES)
@@ -95,15 +95,15 @@
 
     def augment_images(
         self,
         images,
         transformations=None,
         bounding_boxes=None,
         labels=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(images, TF_ALL_TENSOR_TYPES)
         assert isinstance(transformations, TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(labels, TF_ALL_TENSOR_TYPES)
         return images
@@ -111,15 +111,15 @@
     def augment_labels(
         self,
         labels,
         transformations=None,
         bounding_boxes=None,
         images=None,
         raw_images=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(labels, TF_ALL_TENSOR_TYPES)
         assert isinstance(transformations, TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(images, TF_ALL_TENSOR_TYPES)
         assert isinstance(raw_images, TF_ALL_TENSOR_TYPES)
@@ -128,15 +128,15 @@
     def augment_bounding_boxes(
         self,
         bounding_boxes,
         transformations=None,
         labels=None,
         images=None,
         raw_images=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(transformations, TF_ALL_TENSOR_TYPES)
         assert isinstance(labels, TF_ALL_TENSOR_TYPES)
         assert isinstance(images, TF_ALL_TENSOR_TYPES)
         assert isinstance(raw_images, TF_ALL_TENSOR_TYPES)
@@ -146,15 +146,15 @@
         self,
         keypoints,
         transformations=None,
         labels=None,
         bounding_boxes=None,
         images=None,
         raw_images=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(keypoints, TF_ALL_TENSOR_TYPES)
         assert isinstance(transformations, TF_ALL_TENSOR_TYPES)
         assert isinstance(labels, TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(images, TF_ALL_TENSOR_TYPES)
@@ -165,15 +165,15 @@
         self,
         segmentation_mask,
         transformation=None,
         label=None,
         bounding_boxes=None,
         image=None,
         raw_image=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(segmentation_mask, TF_ALL_TENSOR_TYPES)
         assert isinstance(transformation, TF_ALL_TENSOR_TYPES)
         assert isinstance(label, TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(image, TF_ALL_TENSOR_TYPES)
@@ -184,15 +184,15 @@
         self,
         segmentation_masks,
         transformations=None,
         labels=None,
         bounding_boxes=None,
         images=None,
         raw_images=None,
-        **kwargs
+        **kwargs,
     ):
         assert isinstance(segmentation_masks, TF_ALL_TENSOR_TYPES)
         assert isinstance(transformations, TF_ALL_TENSOR_TYPES)
         assert isinstance(labels, TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["boxes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(bounding_boxes["classes"], TF_ALL_TENSOR_TYPES)
         assert isinstance(images, TF_ALL_TENSOR_TYPES)
```

## keras_aug/layers/preprocessing/geometry/center_crop.py

```diff
@@ -91,14 +91,21 @@
         return {
             "pad_tops": tops,
             "pad_bottoms": bottoms,
             "pad_lefts": lefts,
             "pad_rights": rights,
         }
 
+    def compute_ragged_image_signature(self, images):
+        return tf.RaggedTensorSpec(
+            shape=(self.height, self.width, images.shape[-1]),
+            ragged_rank=1,
+            dtype=self.compute_dtype,
+        )
+
     def augment_ragged_image(self, image, transformation, **kwargs):
         image = tf.expand_dims(image, axis=0)
         transformation = augmentation_utils.expand_dict_dims(
             transformation, axis=0
         )
         image = self.augment_images(
             images=image, transformations=transformation, **kwargs
@@ -134,15 +141,15 @@
             offset_width,
             self.height,
             self.width,
         )
         images = tf.ensure_shape(
             images, shape=(None, self.height, self.width, None)
         )
-        return images
+        return tf.cast(images, dtype=self.compute_dtype)
 
     def augment_labels(self, labels, transformations, **kwargs):
         return labels
 
     def augment_bounding_boxes(
         self,
         bounding_boxes,
@@ -259,15 +266,15 @@
             offset_width,
             self.height,
             self.width,
         )
         segmentation_masks = tf.ensure_shape(
             segmentation_masks, shape=(None, self.height, self.width, None)
         )
-        return segmentation_masks
+        return tf.cast(segmentation_masks, dtype=self.compute_dtype)
 
     def get_config(self):
         config = super().get_config()
         config.update(
             {
                 "height": self.height,
                 "width": self.width,
```

## keras_aug/layers/preprocessing/geometry/center_crop_test.py

```diff
@@ -228,7 +228,34 @@
         result = layer(
             {"images": images, "segmentation_masks": segmentation_masks}
         )
 
         self.assertTrue(isinstance(result["segmentation_masks"], tf.Tensor))
         self.assertEqual(result["segmentation_masks"].shape[1:3], (4, 4))
         self.assertAllInSet(result["segmentation_masks"], tf.range(0, 10))
+
+    def test_ragged_input_with_graph_mode(self):
+        images = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 3), dtype=tf.float32),
+                tf.random.uniform((16, 8, 3), dtype=tf.float32),
+            ]
+        )
+        segmentation_masks = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((16, 8, 1), maxval=10, dtype=tf.int32),
+            ]
+        )
+        args = self.regular_args.copy()
+        args.update({"height": 8, "width": 8})
+        layer = layers.CenterCrop(**args)
+
+        @tf.function
+        def fn(inputs):
+            outputs = layer(inputs)
+            image_shape = outputs["images"].shape
+            segmentation_mask_shape = outputs["segmentation_masks"].shape
+            assert image_shape == (2, 8, 8, 3)
+            assert segmentation_mask_shape == (2, 8, 8, 1)
+
+        fn({"images": images, "segmentation_masks": segmentation_masks})
```

## keras_aug/layers/preprocessing/geometry/resize.py

```diff
@@ -153,14 +153,21 @@
             "scaled_sizes": scaled_sizes,
             "tops": tops,
             "bottoms": bottoms,
             "lefts": lefts,
             "rights": rights,
         }
 
+    def compute_ragged_image_signature(self, images):
+        return tf.RaggedTensorSpec(
+            shape=(self.height, self.width, images.shape[-1]),
+            ragged_rank=1,
+            dtype=self.compute_dtype,
+        )
+
     def augment_ragged_image(self, image, transformation, **kwargs):
         image = tf.expand_dims(image, axis=0)
         transformation = augmentation_utils.expand_dict_dims(
             transformation, axis=0
         )
         image = self.augment_images(
             images=image, transformations=transformation, **kwargs
```

## keras_aug/layers/preprocessing/geometry/resize_test.py

```diff
@@ -593,7 +593,34 @@
         result = layer(
             {"images": images, "segmentation_masks": segmentation_masks}
         )
 
         self.assertTrue(isinstance(result["segmentation_masks"], tf.Tensor))
         self.assertEqual(result["segmentation_masks"].shape[1:3], (8, 8))
         self.assertAllInSet(result["segmentation_masks"], tf.range(0, 10))
+
+    def test_ragged_input_with_graph_mode(self):
+        images = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 3), dtype=tf.float32),
+                tf.random.uniform((16, 8, 3), dtype=tf.float32),
+            ]
+        )
+        segmentation_masks = tf.ragged.stack(
+            [
+                tf.random.uniform((8, 8, 1), maxval=10, dtype=tf.int32),
+                tf.random.uniform((16, 8, 1), maxval=10, dtype=tf.int32),
+            ]
+        )
+        args = self.regular_args.copy()
+        args.update({"height": 8, "width": 8})
+        layer = layers.Resize(**args)
+
+        @tf.function
+        def fn(inputs):
+            outputs = layer(inputs)
+            image_shape = outputs["images"].shape
+            segmentation_mask_shape = outputs["segmentation_masks"].shape
+            assert image_shape == (2, 8, 8, 3)
+            assert segmentation_mask_shape == (2, 8, 8, 1)
+
+        fn({"images": images, "segmentation_masks": segmentation_masks})
```

## keras_aug/layers/preprocessing/intensity/normalize.py

```diff
@@ -26,15 +26,15 @@
     """
 
     def __init__(
         self,
         value_range,
         mean=(0.485, 0.456, 0.406),
         std=(0.229, 0.224, 0.225),
-        **kwargs
+        **kwargs,
     ):
         super().__init__(**kwargs)
         self.value_range = value_range
         self.mean_input = mean
         self.std_input = std
 
         num_channel = len(mean)
```

## Comparing `keras_aug-0.5.2.dist-info/LICENSE` & `keras_aug-0.5.3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `keras_aug-0.5.2.dist-info/RECORD` & `keras_aug-0.5.3.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,9 +1,9 @@
-keras_aug/__init__.py,sha256=RpPSacsBATm4W-gxUwwZdNQHPhxMvCdYyxCGwV2Fxvo,373
-keras_aug/conftest.py,sha256=avtORNn5lKJpdUDRtv2TEpRSRzK5AqxgD4Jkp8tNTfs,174
+keras_aug/__init__.py,sha256=pQ4NxxY-M-3jV2wRBTqjtUM9IN6DVnvYnraXFok316M,373
+keras_aug/conftest.py,sha256=3SfvPHRYnz2pV92LgAnQR1wwAyLlxa3BOVMP6JwAmYE,715
 keras_aug/core/__init__.py,sha256=su93JAWbd6gzGUCUk_JOrMvEj-wfMjeH6cz_Mv9co0I,572
 keras_aug/core/factor_sampler/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 keras_aug/core/factor_sampler/constant_factor_sampler.py,sha256=VV9uG0s3hnOl6SttPouC-gHn9xw5V7ImG6_I9_hRJYY,727
 keras_aug/core/factor_sampler/constant_factor_sampler_test.py,sha256=-DVb7zOpqCC9A686eWf67-QR1ZDsextVSwr16z8e7Vs,666
 keras_aug/core/factor_sampler/factor_sampler.py,sha256=125dXun9jKo1BnWYBQ9YU6mYcreEv2SBIeGoqxYbEwU,944
 keras_aug/core/factor_sampler/normal_factor_sampler.py,sha256=XKQpXmFzTxHxKa7ihy0PD3eyB8tMEQgxxkGvlo6P-tQ,1585
 keras_aug/core/factor_sampler/normal_factor_sampler_test.py,sha256=5rl5WwP_Jr9Edq833h7h-UB3vcRymNd1qqLQdXUE1eI,949
@@ -14,120 +14,125 @@
 keras_aug/core/factor_sampler/uniform_factor_sampler.py,sha256=-84aO6gJyWlIPcF6UmiVtkvaR-oFZupywH8HLwzbmM4,1204
 keras_aug/core/factor_sampler/uniform_factor_sampler_test.py,sha256=uvgBbbBN366kt8k56dppdSS3Vy09BORUYpX9n_9TJ90,778
 keras_aug/layers/__init__.py,sha256=SMUjTK4pYg7gKX7L56Nvcj8sEmMoK3zNk1RWjFFfHk8,3641
 keras_aug/layers/__internal__/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 keras_aug/layers/__internal__/base_layer.py,sha256=hxTmf_U5jaXDoM1Af15MNlNFn10cexh1LL6OMdiswNc,2641
 keras_aug/layers/__internal__/base_layer_test.py,sha256=2_pAbKJg07fqbAcDM9tma3YfU29Fz9UAar5qsIuCWfE,1260
 keras_aug/layers/__internal__/config_test.py,sha256=E4Z7MViAl_tZ0SRi1N12bSf53X7bey5k86J9TpCRT7w,7763
-keras_aug/layers/__internal__/graph_xla_mode_test.py,sha256=v61hmqkDRzv_5owJp5PhxEKYIeBVNY7q605ia74qMRA,10731
+keras_aug/layers/__internal__/graph_xla_mode_test.py,sha256=VeaFp3eM3uF2JHgkRujKbqCLXnYWAOZnafujFoW8AGk,10816
 keras_aug/layers/__internal__/mixed_precision_test.py,sha256=TuG65ItEvYytSNeJ7Dlr10SZdZ51QlVaKhzPbcC0QIU,10954
-keras_aug/layers/__internal__/output_common_test.py,sha256=h4w4sL83ocnXvVAIPQf-qfiZRBCe1UbyEl0ZFM98npU,16428
+keras_aug/layers/__internal__/output_common_test.py,sha256=Qhpzx6hLLNk3-Gtszi58It65d9GtkXqV7uqE8Qeyt54,16551
+keras_aug/layers/__internal__/with_bounding_boxes_test.py,sha256=OByvYnryDS8nqE-A_iAyPsF9CJppIXFON-AYMMsFejM,10387
 keras_aug/layers/__internal__/with_ragged_image_test.py,sha256=C2itJM7RlCigvO2a-Lxkvl60GbXTVrGZpodIIUMBKVI,11480
 keras_aug/layers/augmentation/__init__.py,sha256=tw0qOvF7qlo89cH1yzXjU461gguVoFjz36ER_z13b5g,2718
 keras_aug/layers/augmentation/auto/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-keras_aug/layers/augmentation/auto/aug_mix.py,sha256=HG6qMbL9fj-dNFLBh0YgOilB9DQpPldiu6CqWkrjOIY,12271
+keras_aug/layers/augmentation/auto/aug_mix.py,sha256=V48WFrYBFKIh2OJm8jXOtpgPpn019hIiWGVkHj9b9NQ,12325
 keras_aug/layers/augmentation/auto/aug_mix_test.py,sha256=S-RwDK_do8uvD1o_2Kfb4vuSLToQadqb3Wi0MVkKb_M,815
-keras_aug/layers/augmentation/auto/rand_augment.py,sha256=xWle5W8gTPczHikgXoJbKfdjuaBHLxcP2pnrQCn1VOY,18413
+keras_aug/layers/augmentation/auto/rand_augment.py,sha256=9k8aOpGYxkEOQ1CAd7PGrax78mmQdozp0tvXWKR9s5M,18859
 keras_aug/layers/augmentation/auto/rand_augment_test.py,sha256=TXdQ61Pyh-4o6VvNr5NB660NAQhVVv7NUi_8WH2ebWo,1281
-keras_aug/layers/augmentation/auto/trivial_augment_wide.py,sha256=vMchjaYnDu0yHYuDcK3hKfPa9JdCinewUIF5x0_Yd7U,14525
+keras_aug/layers/augmentation/auto/trivial_augment_wide.py,sha256=w5MQwm0yjsh4417GpxaAolocCj3Uob-3dYPin6Tmc-8,14971
 keras_aug/layers/augmentation/auto/trivial_augment_wide_test.py,sha256=pD2R4-IMcJ-pvCLWA_q-AkawFvSuM5RDFfVD1eobMpc,368
 keras_aug/layers/augmentation/geometry/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 keras_aug/layers/augmentation/geometry/random_affine.py,sha256=QujAA1cL9pPE-MDZ0a3aieWYn7Cydkrw8D6myribScU,23246
 keras_aug/layers/augmentation/geometry/random_affine_test.py,sha256=gu_IRjevYpAenWLkH6_q49eia8LpeMXHXQfFdhLg2Tw,15409
 keras_aug/layers/augmentation/geometry/random_crop.py,sha256=4qBe7oH1yiYXvNFdYBPAAGgVLfNZzSqE8uYMwtpMXd8,12054
 keras_aug/layers/augmentation/geometry/random_crop_and_resize.py,sha256=0eEqlqJa9xK1pBQhrzGjbWP_lDLMpgwZzbGUWZtMb1k,11758
-keras_aug/layers/augmentation/geometry/random_crop_and_resize_test.py,sha256=1Dj0nDtszmfZxbwyJu5yigLhSdg-aLkD0HtafQXSLQY,9817
-keras_aug/layers/augmentation/geometry/random_crop_test.py,sha256=Dn4Jila_FH4rYHgghS6euWX5EDYjAyUT_TrR8bGffNw,7738
+keras_aug/layers/augmentation/geometry/random_crop_and_resize_test.py,sha256=2EVY311ilwgI0C79bxeBSz-JhFbGaFaAnifF5iUyhxA,10996
+keras_aug/layers/augmentation/geometry/random_crop_test.py,sha256=deSvdo-pMB6-RcYDf21Za-9nGNHLxoODCV8iYGod7dY,8659
 keras_aug/layers/augmentation/geometry/random_flip.py,sha256=Gp_MYa9mCg3z7MP2_cd57yRWMQC4Nlkg1FvLLcv4PsQ,7997
 keras_aug/layers/augmentation/geometry/random_flip_test.py,sha256=ES_GVA5S3aRur99rykVlUclyyuqxU1q6qa4IEhup1es,11147
 keras_aug/layers/augmentation/geometry/random_resize.py,sha256=P9QJ1eQdGMeTvZbWJaNro6hXaObqd1_pVgXYPqyBGDM,7186
 keras_aug/layers/augmentation/geometry/random_resize_test.py,sha256=7Y81M0ZQtwfqHnYSlwJd_YHXAvb6GbKAJ9y3BBGX7VI,8591
 keras_aug/layers/augmentation/geometry/random_rotate.py,sha256=0NI1yxmzihUkwqaeOq5EmQi1MunfS1DR0jt4FwX4E5k,9239
 keras_aug/layers/augmentation/geometry/random_rotate_test.py,sha256=mMS6xB_KyWHnWak0Pb31VkkruF30VAp7MIm3rMD7FPk,7395
 keras_aug/layers/augmentation/geometry/random_zoom_and_crop.py,sha256=ebSBt4_ES6gAofiIQaC7TZ019url8yRAR9a62BJ_gm0,12633
-keras_aug/layers/augmentation/geometry/random_zoom_and_crop_test.py,sha256=AS_71ko8qtWw2cdyNtQsUFmoD-4CS2EX4yP_WrfSbyM,6808
+keras_aug/layers/augmentation/geometry/random_zoom_and_crop_test.py,sha256=vykzdD--DCuI0OEq82_f30jHZGuZf4ds5om5Y6nJ3uM,7787
 keras_aug/layers/augmentation/intensity/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 keras_aug/layers/augmentation/intensity/channel_shuffle.py,sha256=E35wT-ogq3zGo7zdRN51hkfCCspPlTVhrJ_D3kyKgRs,3356
 keras_aug/layers/augmentation/intensity/channel_shuffle_test.py,sha256=iIecfbCnfx6sq8WyO-mbO5b38E4bE4wQ0ZldGf_yc8M,1633
 keras_aug/layers/augmentation/intensity/random_blur.py,sha256=HUB47YZj9I_UKK31R_c7LALcaEa5hFB7vZg5FyaMu_w,4167
 keras_aug/layers/augmentation/intensity/random_blur_test.py,sha256=lyTbq2csU01kbQqrx0YkBsXHFK7u-T7s9zILDcuwR_Q,1010
 keras_aug/layers/augmentation/intensity/random_channel_shift.py,sha256=sOp34yRyufS8qEWCRnvM21vduK-43YTcSZO40yefs4U,3481
 keras_aug/layers/augmentation/intensity/random_channel_shift_test.py,sha256=E9TERzTBqz4ENh2TaFBEoXG3nUh6r0zRRCsWHIKE5Jg,1506
 keras_aug/layers/augmentation/intensity/random_clahe.py,sha256=qufCOws_wawNSepakZf4pHKqUDaigCgUZtsWITrH9Kc,9563
 keras_aug/layers/augmentation/intensity/random_clahe_test.py,sha256=7mAkrLb1Wc_A8S3-OO4dmcgiH_QnX49u8UgisMgMppk,3093
-keras_aug/layers/augmentation/intensity/random_color_jitter.py,sha256=u4EWixgIJjnx5jTQ8rnNZxv-X2Cad7k_xJEYNTfVUm4,9411
+keras_aug/layers/augmentation/intensity/random_color_jitter.py,sha256=L0NMb7Q-3DYERkGHnpIgJjF37zSLmh0WWLFPw3uK_TM,9412
 keras_aug/layers/augmentation/intensity/random_color_jitter_test.py,sha256=Waw7qJgxAfFdEUJEYBWxH6Rq1GFBl79rF162_GKeto8,5660
 keras_aug/layers/augmentation/intensity/random_gamma.py,sha256=luvjhKKrFDD5ZWxhpjRUfheM4eSZT2GmZfVydqwt2ZM,3430
 keras_aug/layers/augmentation/intensity/random_gamma_test.py,sha256=ls7ysnUnDMESSJIhKg2JsWk5yTRWUstNuYBAAgZY0AI,1420
 keras_aug/layers/augmentation/intensity/random_gaussian_blur.py,sha256=PD_De8UFjoPPrjezKTjIBYP2vowHQ7f4N39S3RqKXDc,5256
 keras_aug/layers/augmentation/intensity/random_gaussian_blur_test.py,sha256=qA92xgLNCs3ojCG71rF_1AuaUL2gmTP82DYXTyClnd0,2098
-keras_aug/layers/augmentation/intensity/random_hsv.py,sha256=mcaqf0RRY_N8KjIyikyKnrpSQdWUJwLDMZhmsHLcKyw,7785
+keras_aug/layers/augmentation/intensity/random_hsv.py,sha256=zdsYPGQCfajmyZaZQV5uBaujUBY1WFy2XzB0B_D3qhg,7786
 keras_aug/layers/augmentation/intensity/random_hsv_test.py,sha256=3pzxPYraIU4RWE20dRm3oJrjAbzA1nc72-PxIs9JKfs,5230
 keras_aug/layers/augmentation/intensity/random_jpeg_quality.py,sha256=AMdMBbKhUoMcWUie5ZQzwiG_xO-V5flBxG377ebeso0,4503
 keras_aug/layers/augmentation/intensity/random_jpeg_quality_test.py,sha256=FoXChDSgkP9IukBLYIlHxuYjO_yeCW0X_HDFbh_T8Rs,1155
 keras_aug/layers/augmentation/intensity/random_posterize.py,sha256=D3MGbjWfZV-k0y6Fi0_7Rc5pRPCcs0NFe66WTwuj9VE,4388
 keras_aug/layers/augmentation/intensity/random_posterize_test.py,sha256=mYsi57joSP_f4ZB5h0ywq3GQTlKWw-tamlSlEhvobQ0,2768
 keras_aug/layers/augmentation/intensity/random_sharpness.py,sha256=y7R9WjYqLNbIg8EDMzeOjlc4fL33Dex4FrqJNhaXEr8,5116
 keras_aug/layers/augmentation/intensity/random_sharpness_test.py,sha256=Sl-RwdORHIP_nFPzpmircSkRwDfIfFznHLdX7SNQF7s,1366
-keras_aug/layers/augmentation/intensity/random_solarize.py,sha256=PiqPlO4UNjS8WwPoCabxlegKiyK4vGohJ5kEfb1dDBE,5125
+keras_aug/layers/augmentation/intensity/random_solarize.py,sha256=X0ArPegU-Bfz-7kkEsaFOvLvZdsKGLX46fqfVN89D70,5126
 keras_aug/layers/augmentation/intensity/random_solarize_test.py,sha256=wGv4CMkqSHSQQQcxNFaK5JhlfLnL0by06gdfUwr5XMc,2269
 keras_aug/layers/augmentation/mix/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-keras_aug/layers/augmentation/mix/cut_mix.py,sha256=v8eQr17L0Ia370g6z89JdxNRN18GyyLDwHyMH7mpBOo,7143
+keras_aug/layers/augmentation/mix/cut_mix.py,sha256=oJdH27fXQRLUG2az4803GEXzpaDCqcvG1H8VJJ3ssUU,7139
 keras_aug/layers/augmentation/mix/cut_mix_test.py,sha256=ovlqGpZhwm1upzXfPcaK3qgLXhqB2qc91-7f-1wbjgs,4258
-keras_aug/layers/augmentation/mix/mix_up.py,sha256=uoGWTXLzzXsHNcFoCI3eEY2HsA67ikqpBXYCbIXMkzc,6149
+keras_aug/layers/augmentation/mix/mix_up.py,sha256=GXv5dFPrsi3R48Cv7yL5kF2YcvtCPXn7rX1iLKv53ZQ,6145
 keras_aug/layers/augmentation/mix/mix_up_test.py,sha256=KEkin-aR2z0AhiKwJxRS5bL1JDF73gAy-GJ3oUV19KE,2947
-keras_aug/layers/augmentation/mix/mosaic.py,sha256=LeR2K6AwT4nHqrQKoxY7A4qinuh9faGMXH4gaAPRJdI,16288
-keras_aug/layers/augmentation/mix/mosaic_test.py,sha256=IeL4RqoH7koON71vUV4wgJT0iNTl-m6YBTOXFrnYio4,2297
+keras_aug/layers/augmentation/mix/mosaic.py,sha256=znCUfLo7RsHnB8_Tw6PGMTXf6md6CrKizbjJE85I5JQ,17535
+keras_aug/layers/augmentation/mix/mosaic_test.py,sha256=QME-RESeVZKhUAdhXSbYi5zN71ZvoN7lodGADDxuT-U,3801
 keras_aug/layers/augmentation/regularization/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 keras_aug/layers/augmentation/regularization/random_channel_dropout.py,sha256=FEVeDXfaPL4ZMT5a_SYLkbhwNExq9EZzJ-G7rprh5WU,3737
 keras_aug/layers/augmentation/regularization/random_channel_dropout_test.py,sha256=WD_dn-QPsj5XouGp-DG38TZgpPUhgmWRbfwMc1KmBuY,706
 keras_aug/layers/augmentation/regularization/random_cutout.py,sha256=EF3WYSjybFwgD0vjAE-T9Xbsz3MYx-upkI5AL6VDu7c,9425
 keras_aug/layers/augmentation/regularization/random_cutout_test.py,sha256=0qq8LouUR0Km9ulqFcA5aHbMrQK8F2K2IFbsn6S0Ho4,3189
 keras_aug/layers/augmentation/regularization/random_erase.py,sha256=N-_0j2v9PCSKAL2ogmeI8L9qMQB0j6aNiv5cBjjBc3Y,7296
 keras_aug/layers/augmentation/regularization/random_erase_test.py,sha256=d53rMfqVNVvz44nEQ-YnjisUbP1towMXFjad_yVfmHw,3236
 keras_aug/layers/augmentation/regularization/random_grid_mask.py,sha256=g9VvlYRHtQAa0zBp3FrMRwnQVPkCfHqRvyncoJD1eI8,10927
 keras_aug/layers/augmentation/regularization/random_grid_mask_test.py,sha256=2v4styEiep1EE5WujsDueoUW_FT_aWtZVJKaChz9Lqk,2161
 keras_aug/layers/augmentation/utility/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-keras_aug/layers/augmentation/utility/random_apply.py,sha256=a62pFsOCuY90cnMUw7yE06nvcDDpspnZzQzdHiT4iGY,6080
+keras_aug/layers/augmentation/utility/random_apply.py,sha256=bVusasQLdph-1jCDAAtCL58ZZS3bLcfzo44W3nQcHVg,6555
 keras_aug/layers/augmentation/utility/random_apply_test.py,sha256=aSycm6w77fAmbjwxx_jlGcVGL9p77bfztMMr1ykBbms,2792
-keras_aug/layers/augmentation/utility/random_choice.py,sha256=I7qREwRkTmffHxB8JInqlwRyFlXfm-UwAw70rcWGMZc,6457
+keras_aug/layers/augmentation/utility/random_choice.py,sha256=1gR6XQEMtsBOFCCo6d7ermPfQ9yFkG_si9wUJuQ-6eI,6932
 keras_aug/layers/augmentation/utility/random_choice_test.py,sha256=CtATBligXBzrrBtSTgNzs8ny_ueiEiBQ7Nz0vyJ5PU0,2732
 keras_aug/layers/augmentation/utility/repeated_augment.py,sha256=wtR-oAo8gi09JTdjmCfr8IfkJAx4r931JyjBWq7CBFE,3588
 keras_aug/layers/augmentation/utility/repeated_augment_test.py,sha256=2VJXo_X9dW4gGRRibknhWxkNyoD4kgamrhxTHLVEcFE,1106
 keras_aug/layers/base/__init__.py,sha256=MaYYjGjqxMesKTnNAJyjQi97ZRM7CM2F5KA-BfpiMxM,98
-keras_aug/layers/base/vectorized_base_random_layer.py,sha256=nVUM0XdUwASkST7-YJoOWeBEV8GPzKkwbtmQxAyMZ_Q,24094
-keras_aug/layers/base/vectorized_base_random_layer_test.py,sha256=YZotN9fBol5iKI7PFpJqQg388WBDFiLBv4HwL1taax4,22086
+keras_aug/layers/base/vectorized_base_random_layer.py,sha256=1yCPwcJ3DI_tSMgUAF1i64xgVLv3lSXRYFUVyKgeDl4,24269
+keras_aug/layers/base/vectorized_base_random_layer_test.py,sha256=_vcLx0qDit_MPiYaTzX1Yt9eceAosF0F_dmrHinMh4c,22094
 keras_aug/layers/preprocessing/__init__.py,sha256=71fAwRUtZVKkRNbQrDgJ5gOhgDzvOTS8RMLMGr3FoM8,825
 keras_aug/layers/preprocessing/geometry/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-keras_aug/layers/preprocessing/geometry/center_crop.py,sha256=vUAl5EpMnFP0Bvk4vnt6E7WEjEDO3XhPVd5zVS5VJZU,10864
-keras_aug/layers/preprocessing/geometry/center_crop_test.py,sha256=9-PFSgp4Qz2YSMk61fwInFUxrmBAPk-V9rpZNQRRnq8,8368
+keras_aug/layers/preprocessing/geometry/center_crop.py,sha256=YoAxr3C9ltf6kKrw-0UCnwxfPIxygu5s6TXdDkzsih8,11163
+keras_aug/layers/preprocessing/geometry/center_crop_test.py,sha256=IbYK1KeN78JnVZQtyWbYQtGPkxkV7cysuR7vg2dunxY,9365
 keras_aug/layers/preprocessing/geometry/pad_if_needed.py,sha256=w2QwQkAR_S4qg0KIZanPs-OV6mXyNOK5-xuKsZxkZzk,10833
 keras_aug/layers/preprocessing/geometry/pad_if_needed_test.py,sha256=n3eFxoA-B92eRKT-hAwFwanvHFsZZsPaMBYvAAuuIUc,9878
-keras_aug/layers/preprocessing/geometry/resize.py,sha256=vSNDnkQblm3w6zCeLVNReZ5Gjhs2tBnfIBsNFf5lGII,15545
-keras_aug/layers/preprocessing/geometry/resize_test.py,sha256=g1o2U1X6keQEDL5aa40Qzw_bYTKkfnsvhMPWPz6ZUW0,22167
+keras_aug/layers/preprocessing/geometry/resize.py,sha256=iJVAsyZT1s840MpnXG9f2ZvJqU76FP8fEAsWIkHxO7A,15774
+keras_aug/layers/preprocessing/geometry/resize_test.py,sha256=mippY8kkddfwkYdOHongba03CSYodrnkyk4dKmWyqKQ,23160
 keras_aug/layers/preprocessing/intensity/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 keras_aug/layers/preprocessing/intensity/auto_contrast.py,sha256=s-o7Iv_cBpbeyQOLtK3Rz3vkQWAih8_1c9vCd8tiZrI,2878
 keras_aug/layers/preprocessing/intensity/auto_contrast_test.py,sha256=MP-rK8KaALldUhdZ0m05E9brf7JAOJGQXz52UyxcM2E,2698
 keras_aug/layers/preprocessing/intensity/equalize.py,sha256=CBuOK6fiPXkk5bBeCQLcZPRARyzb4G8_B8UkJ51nB9k,4513
 keras_aug/layers/preprocessing/intensity/equalize_test.py,sha256=KyPNwIUt2CzxJxMhmqSx6_Zqrr2336oJbMublXUMg8M,1529
 keras_aug/layers/preprocessing/intensity/grayscale.py,sha256=x4PfC-VHFiTkpdgA9Etk-k2_HAx9rm9NCZ4Z3MH9yIE,2376
 keras_aug/layers/preprocessing/intensity/grayscale_test.py,sha256=GQCq1YcKtibK5jaczt3izY5-aQdXBfjPrpY4O6al8SA,1224
 keras_aug/layers/preprocessing/intensity/identity.py,sha256=3cFSp-xde2_CFmKfchlv-2mqUJzJ98S296VZ-yqWq7c,1023
 keras_aug/layers/preprocessing/intensity/identity_test.py,sha256=ZuT-J5FolVarkn8_HP_ZVqdgvJk4IF3N8H_rl9bA8Iw,1391
 keras_aug/layers/preprocessing/intensity/invert.py,sha256=HonGomgRkstpmqLCsNcDo8hXI0WTKNQby3VqxYsySfA,1653
 keras_aug/layers/preprocessing/intensity/invert_test.py,sha256=R5dMDK3xEXRHnUkoglhPSH9-NX27l8Q_xdVwqiX6ED0,459
-keras_aug/layers/preprocessing/intensity/normalize.py,sha256=_K5Z4Agk6ccm3miDIiHfNCmu1cnLyyrzOS8CVrnHupk,2931
+keras_aug/layers/preprocessing/intensity/normalize.py,sha256=l3aOrNHTOEmm1ssnBGZyh-DFfSfZdXoA8el8rtWaA2M,2932
 keras_aug/layers/preprocessing/intensity/normalize_test.py,sha256=t_pKz0tAXd4K2wpOqZOY8AFfsxtX7Czv9soyEFiXjzA,1483
 keras_aug/layers/preprocessing/intensity/rescale.py,sha256=DQsimIZrdtDFcQNuTfS3ibG-4LhLeahTqk-ePcd5G7o,1923
 keras_aug/layers/preprocessing/intensity/rescale_test.py,sha256=AHYYlcfLN7EDCoQKEKVcHzy7wzLbZPrkdMB808miATU,1365
+keras_aug/layers/preprocessing/utility/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+keras_aug/layers/preprocessing/utility/sanitize_bounding_box.py,sha256=Plz8Iu43cYpjM9V09FbI2ia1GGLSMhxlccmQO1f2QHI,3174
+keras_aug/layers/preprocessing/utility/sanitize_bounding_box_test.py,sha256=sg1nSuuR_KaNoCH9FiZhoNkSJTTJHj8_KxIrTuwI-2I,996
 keras_aug/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 keras_aug/utils/augmentation.py,sha256=tXuaz46A-Qy7ny6Xmok93xK24-OKU4mq78FZ_3TZfCE,18127
 keras_aug/utils/augmentation_test.py,sha256=dC1PrcuSZZIUAa3tY4SEKjIsnpAgswf9HCaNItaogKQ,7832
 keras_aug/utils/bounding_box.py,sha256=6--joJSNVjoivaGndngzfL1SbfygJDDQtTdx8iLOJgs,8682
 keras_aug/utils/bounding_box_test.py,sha256=q3NicuCAB_0vai1OCGXXCfkpziqcivK_vl_-fu00Jqg,3235
 keras_aug/utils/conditional_imports.py,sha256=90U2Wj_Fuvfn01ipGtnZdYvd9MO2THDZMhZq6Os_ErE,373
 keras_aug/utils/demo.py,sha256=V5Jt-6RPaXEFDl0MCIrBxSZD8vaIvKFcvL8Igb7K0cQ,6101
-keras_aug-0.5.2.dist-info/LICENSE,sha256=xktsWk7LDJmjQ7sU46fqqpB4cWW9iXjs85qc_fRAxSg,11456
-keras_aug-0.5.2.dist-info/METADATA,sha256=mXGx36fFncDlzZbNTJ5n3N384yDUgXWinivmw3n5FiM,13601
-keras_aug-0.5.2.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-keras_aug-0.5.2.dist-info/top_level.txt,sha256=fR_dHLAAVS4WR1ywYPQARPvXVCtPMeCSd6T_OqIgj28,10
-keras_aug-0.5.2.dist-info/RECORD,,
+keras_aug/utils/distribution.py,sha256=6pAHjmJ6mosG6IQmaUfXBxuUnp0vjI2PIhBz6e6cl9c,740
+keras_aug-0.5.3.dist-info/LICENSE,sha256=xktsWk7LDJmjQ7sU46fqqpB4cWW9iXjs85qc_fRAxSg,11456
+keras_aug-0.5.3.dist-info/METADATA,sha256=akfGJGS2QdEUWQsGlYAZ5-5w0tKxLJRxwtecciSxfF0,26895
+keras_aug-0.5.3.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+keras_aug-0.5.3.dist-info/top_level.txt,sha256=fR_dHLAAVS4WR1ywYPQARPvXVCtPMeCSd6T_OqIgj28,10
+keras_aug-0.5.3.dist-info/RECORD,,
```

