# Comparing `tmp/rayfed_nightly-0.1.0b20230528.dev0-py3-none-any.whl.zip` & `tmp/rayfed_nightly-0.1.0b20230531.dev0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 38450 bytes, number of entries: 25
--rw-r--r--  2.0 unx      853 b- defN 23-May-28 01:42 fed/__init__.py
--rw-r--r--  2.0 unx    16111 b- defN 23-May-28 01:42 fed/api.py
--rw-r--r--  2.0 unx    15662 b- defN 23-May-28 01:42 fed/barriers.py
--rw-r--r--  2.0 unx     3074 b- defN 23-May-28 01:42 fed/cleanup.py
--rw-r--r--  2.0 unx     2280 b- defN 23-May-28 01:42 fed/config.py
--rw-r--r--  2.0 unx     2877 b- defN 23-May-28 01:42 fed/fed_object.py
--rw-r--r--  2.0 unx     7908 b- defN 23-May-28 01:42 fed/tree_util.py
--rw-r--r--  2.0 unx     5254 b- defN 23-May-28 01:42 fed/utils.py
--rw-r--r--  2.0 unx      581 b- defN 23-May-28 01:42 fed/_private/__init__.py
--rw-r--r--  2.0 unx      581 b- defN 23-May-28 01:42 fed/_private/api.py
--rw-r--r--  2.0 unx     4487 b- defN 23-May-28 01:42 fed/_private/compatible_utils.py
--rw-r--r--  2.0 unx     1268 b- defN 23-May-28 01:42 fed/_private/constants.py
--rw-r--r--  2.0 unx     3837 b- defN 23-May-28 01:42 fed/_private/fed_actor.py
--rw-r--r--  2.0 unx     3825 b- defN 23-May-28 01:42 fed/_private/fed_call_holder.py
--rw-r--r--  2.0 unx     1017 b- defN 23-May-28 01:42 fed/_private/global_context.py
--rw-r--r--  2.0 unx     2859 b- defN 23-May-28 01:42 fed/_private/grpc_options.py
--rw-r--r--  2.0 unx     2386 b- defN 23-May-28 01:42 fed/_private/serialization_utils.py
--rw-r--r--  2.0 unx      581 b- defN 23-May-28 01:42 fed/grpc/__init__.py
--rw-r--r--  2.0 unx     5608 b- defN 23-May-28 01:42 fed/grpc/fed_pb2.py
--rw-r--r--  2.0 unx     2955 b- defN 23-May-28 01:42 fed/grpc/fed_pb2_grpc.py
--rw-r--r--  2.0 unx    11356 b- defN 23-May-28 01:44 rayfed_nightly-0.1.0b20230528.dev0.dist-info/LICENSE
--rw-r--r--  2.0 unx     7243 b- defN 23-May-28 01:44 rayfed_nightly-0.1.0b20230528.dev0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-28 01:44 rayfed_nightly-0.1.0b20230528.dev0.dist-info/WHEEL
--rw-r--r--  2.0 unx        4 b- defN 23-May-28 01:44 rayfed_nightly-0.1.0b20230528.dev0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2053 b- defN 23-May-28 01:44 rayfed_nightly-0.1.0b20230528.dev0.dist-info/RECORD
-25 files, 104752 bytes uncompressed, 35152 bytes compressed:  66.4%
+Zip file size: 38986 bytes, number of entries: 25
+-rw-r--r--  2.0 unx      853 b- defN 23-May-31 01:46 fed/__init__.py
+-rw-r--r--  2.0 unx    16196 b- defN 23-May-31 01:46 fed/api.py
+-rw-r--r--  2.0 unx    15662 b- defN 23-May-31 01:46 fed/barriers.py
+-rw-r--r--  2.0 unx     3172 b- defN 23-May-31 01:46 fed/cleanup.py
+-rw-r--r--  2.0 unx     2280 b- defN 23-May-31 01:46 fed/config.py
+-rw-r--r--  2.0 unx     2877 b- defN 23-May-31 01:46 fed/fed_object.py
+-rw-r--r--  2.0 unx     7908 b- defN 23-May-31 01:46 fed/tree_util.py
+-rw-r--r--  2.0 unx     6735 b- defN 23-May-31 01:46 fed/utils.py
+-rw-r--r--  2.0 unx      581 b- defN 23-May-31 01:46 fed/_private/__init__.py
+-rw-r--r--  2.0 unx      581 b- defN 23-May-31 01:46 fed/_private/api.py
+-rw-r--r--  2.0 unx     4487 b- defN 23-May-31 01:46 fed/_private/compatible_utils.py
+-rw-r--r--  2.0 unx     1268 b- defN 23-May-31 01:46 fed/_private/constants.py
+-rw-r--r--  2.0 unx     3837 b- defN 23-May-31 01:46 fed/_private/fed_actor.py
+-rw-r--r--  2.0 unx     3825 b- defN 23-May-31 01:46 fed/_private/fed_call_holder.py
+-rw-r--r--  2.0 unx     1017 b- defN 23-May-31 01:46 fed/_private/global_context.py
+-rw-r--r--  2.0 unx     2859 b- defN 23-May-31 01:46 fed/_private/grpc_options.py
+-rw-r--r--  2.0 unx     2386 b- defN 23-May-31 01:46 fed/_private/serialization_utils.py
+-rw-r--r--  2.0 unx      581 b- defN 23-May-31 01:46 fed/grpc/__init__.py
+-rw-r--r--  2.0 unx     5608 b- defN 23-May-31 01:46 fed/grpc/fed_pb2.py
+-rw-r--r--  2.0 unx     2955 b- defN 23-May-31 01:46 fed/grpc/fed_pb2_grpc.py
+-rw-r--r--  2.0 unx    11356 b- defN 23-May-31 01:49 rayfed_nightly-0.1.0b20230531.dev0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     7243 b- defN 23-May-31 01:49 rayfed_nightly-0.1.0b20230531.dev0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-31 01:49 rayfed_nightly-0.1.0b20230531.dev0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        4 b- defN 23-May-31 01:49 rayfed_nightly-0.1.0b20230531.dev0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2053 b- defN 23-May-31 01:49 rayfed_nightly-0.1.0b20230531.dev0.dist-info/RECORD
+25 files, 106416 bytes uncompressed, 35688 bytes compressed:  66.5%
```

## zipnote {}

```diff
@@ -54,23 +54,23 @@
 
 Filename: fed/grpc/fed_pb2.py
 Comment: 
 
 Filename: fed/grpc/fed_pb2_grpc.py
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230528.dev0.dist-info/LICENSE
+Filename: rayfed_nightly-0.1.0b20230531.dev0.dist-info/LICENSE
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230528.dev0.dist-info/METADATA
+Filename: rayfed_nightly-0.1.0b20230531.dev0.dist-info/METADATA
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230528.dev0.dist-info/WHEEL
+Filename: rayfed_nightly-0.1.0b20230531.dev0.dist-info/WHEEL
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230528.dev0.dist-info/top_level.txt
+Filename: rayfed_nightly-0.1.0b20230531.dev0.dist-info/top_level.txt
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230528.dev0.dist-info/RECORD
+Filename: rayfed_nightly-0.1.0b20230531.dev0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## fed/api.py

```diff
@@ -159,22 +159,24 @@
         >>> # Start as alice.
         >>> fed.init(address='local', cluster=cluster, self_party='alice')
     """
     assert cluster, "Cluster should be provided."
     assert party, "Party should be provided."
     assert party in cluster, f"Party {party} is not in cluster {cluster}."
 
+    fed_utils.validate_address(address)
+    fed_utils.validate_cluster_info(cluster)
+
     compatible_utils.init_ray(address=address, **kwargs)
     tls_config = {} if tls_config is None else tls_config
     if tls_config:
         assert (
             'cert' in tls_config and 'key' in tls_config
         ), 'Cert or key are not in tls_config.'
     # A Ray private accessing, should be replaced in public API.
-
     compatible_utils._init_internal_kv()
     compatible_utils.kv.initialize()
 
     cluster_config = {
         constants.KEY_OF_CLUSTER_ADDRESSES: cluster,
         constants.KEY_OF_CURRENT_PARTY_NAME: party,
         constants.KEY_OF_TLS_CONFIG: tls_config,
```

## fed/cleanup.py

```diff
@@ -43,14 +43,15 @@
 def _check_sending_objs():
     def _signal_exit():
         os.kill(os.getpid(), signal.SIGTERM)
 
     global _sending_obj_refs_q
     if not _sending_obj_refs_q:
         _sending_obj_refs_q = deque()
+
     while True:
         try:
             obj_ref = _sending_obj_refs_q.popleft()
         except IndexError:
             time.sleep(0.5)
             continue
         if isinstance(obj_ref, bool):
@@ -78,14 +79,18 @@
     notify_to_exit()
 
 
 _monitor_thread = None
 
 
 def _start_check_sending():
+    global _sending_obj_refs_q
+    if not _sending_obj_refs_q:
+        _sending_obj_refs_q = deque()
+
     global _check_send_thread
     if not _check_send_thread:
         _check_send_thread = threading.Thread(target=_check_sending_objs)
         _check_send_thread.start()
         logger.info('Start check sending thread.')
 
         global _monitor_thread
@@ -98,16 +103,16 @@
 def push_to_sending(obj_ref: ray.ObjectRef):
     _start_check_sending()
     global _sending_obj_refs_q
     _sending_obj_refs_q.append(obj_ref)
 
 
 def notify_to_exit():
-    global _sending_obj_refs_q
-    _sending_obj_refs_q.append(True)
+    # Sending the termination signal
+    push_to_sending(True)
     logger.info('Notify check sending thread to exit.')
 
 
 def wait_sending():
     global _check_send_thread
     if _check_send_thread:
         notify_to_exit()
```

## fed/utils.py

```diff
@@ -9,14 +9,15 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import logging
+import re
 
 import fed
 import ray
 
 from fed.fed_object import FedObject
 
 logger = logging.getLogger(__name__)
@@ -152,7 +153,46 @@
         return dic
     elif (isinstance(dic, dict)):
         return tuple((k, v) for k, v in dic.items())
     else:
         logger.warn(f"Unable to convert type {type(dic)} to tuple"
                     f"skip converting {dic}.")
         return dic
+
+
+def validate_address(address: str) -> None:
+    if address is None:
+        raise ValueError("The address shouldn't be None.")
+
+    # The specific case for `local` or `localhost`.
+    if address == 'local' or address == 'localhost':
+        return
+
+    # Rule 1: "ip:port" format
+    ip_port_pattern = r'^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}:\d+$'
+    if re.match(ip_port_pattern, address):
+        return
+
+    # Rule 2: "hostname:port" format
+    hostname_port_pattern = r'^[a-zA-Z0-9.-]+:\d+$'
+    if re.match(hostname_port_pattern, address):
+        return
+
+    # Rule 3: https or http link
+    link_pattern = r'^(https?://).*'
+    if re.match(link_pattern, address):
+        return
+
+    error_msg = ("The address format is invalid. It should be in one of the following formats:\n" # noqa
+                "- `local` for starting a new cluster, or `localhost` for connecting a local cluster.\n" # noqa
+                "- 'ip:port' format, where the IP needs to follow the IP address specifications and the port is a number.\n" # noqa
+                "- 'hostname:port' format, where the hostname is a string and the port is a number.\n" # noqa
+                "- An HTTPS or HTTP link starting with 'https://' or 'http://'.") # noqa
+    raise ValueError(error_msg)
+
+
+def validate_cluster_info(cluster: dict):
+    """
+    Validate whether the cluster information is in correct forms.
+    """
+    for _, info in cluster.items():
+        validate_address(info['address'])
```

## Comparing `rayfed_nightly-0.1.0b20230528.dev0.dist-info/LICENSE` & `rayfed_nightly-0.1.0b20230531.dev0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `rayfed_nightly-0.1.0b20230528.dev0.dist-info/METADATA` & `rayfed_nightly-0.1.0b20230531.dev0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: rayfed-nightly
-Version: 0.1.0b20230528.dev0
+Version: 0.1.0b20230531.dev0
 Summary: A multiple parties joint, distributed execution engine based on Ray,to help build your own federated learning frameworks in minutes.
 Home-page: https://github.com/ray-project/rayfed
 Author: RayFed Team
 Author-email: rayfed-dev@googlegroups.com
 License: Apache 2.0
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

## Comparing `rayfed_nightly-0.1.0b20230528.dev0.dist-info/RECORD` & `rayfed_nightly-0.1.0b20230531.dev0.dist-info/RECORD`

 * *Files 11% similar despite different names*

```diff
@@ -1,25 +1,25 @@
 fed/__init__.py,sha256=6Xds1gLndBN-E4GBTuxnc7gf3Zw_D8iNejjA3JTjWnc,853
-fed/api.py,sha256=kFNa0FgyNF1zj9Z3gWjoDgPY5E_wAOswGm3IcYDnbXQ,16111
+fed/api.py,sha256=ANPdFdzFK_tY3wymIKKefaE-8m-SbiYY8yWuCICF8OQ,16196
 fed/barriers.py,sha256=ZBT8P4p7MXC8fqW7hQb6EWEHCU4GsAbNzCseEKicdqA,15662
-fed/cleanup.py,sha256=w4FAOleKE2lv_hLJxq4ien2BdUK0UuMXlw7OSWTm8MI,3074
+fed/cleanup.py,sha256=pYuljYQzeQg572MbbtxdAa1D2-_sZ9hd7Hi4qSippnA,3172
 fed/config.py,sha256=bpflURNHjH224XWM9BUgvMLzH-3BRzZJ_oX0PtdErrw,2280
 fed/fed_object.py,sha256=l2BRa9WZ3jqXSDjwFPURcAIK8XkH8A5UYA_OcY4TOD0,2877
 fed/tree_util.py,sha256=25LiGASBcreE34OsGsoeRWH4t6BuBk3QVcKjCe38jTI,7908
-fed/utils.py,sha256=gMJrnH9-EPkcWrwWyXRtnl5HOGeCl1kP2Gc0In7m5es,5254
+fed/utils.py,sha256=FfvqkErgpJ7U9r5pm8rzjzAQhEvrZyI-xUkTfU6l5F0,6735
 fed/_private/__init__.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
 fed/_private/api.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
 fed/_private/compatible_utils.py,sha256=ZhaLX797pZ-PnwlNIMgRzkwrysW0wbruQLHm-WsNUUs,4487
 fed/_private/constants.py,sha256=r0vt4ueAsB3cyNVOQ8lJZgCCDosYHgNYZblaUfapk1o,1268
 fed/_private/fed_actor.py,sha256=8nqXO_l9yOno5duMiEhWagp9q9-w696erKos-RgcnoU,3837
 fed/_private/fed_call_holder.py,sha256=uJhmyq1nIn4nqJUg1bOqjgXrgFscZHsdpi5pXrXPF2M,3825
 fed/_private/global_context.py,sha256=dlfeqdp6C_5bGDvzHcxbR6xZGELfVyoQtDIZ4ampwZw,1017
 fed/_private/grpc_options.py,sha256=_r43xjQfg0JmD0T447wHV42EYhP0YpBubsGKG22TuN4,2859
 fed/_private/serialization_utils.py,sha256=l63nacVabcyKpys9tVT2zUMmKecimeVflsJ6v45AYvc,2386
 fed/grpc/__init__.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
 fed/grpc/fed_pb2.py,sha256=CKRJyBIx8MG4XtqtARL9ETFEyIsX2ksO0IVU9JgBhWQ,5608
 fed/grpc/fed_pb2_grpc.py,sha256=PsTotUwY4gEHWV0gQnPwpoQWdNJCczNZti6bJBYFj5Q,2955
-rayfed_nightly-0.1.0b20230528.dev0.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
-rayfed_nightly-0.1.0b20230528.dev0.dist-info/METADATA,sha256=34rBnLGn4WOQAskVkn2ZVvF5O0mdRIEfW2Ugg282zpU,7243
-rayfed_nightly-0.1.0b20230528.dev0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-rayfed_nightly-0.1.0b20230528.dev0.dist-info/top_level.txt,sha256=5gd1qhbpzLAi36ONV8p_s65_-iAiOSwFljYh-ONEwts,4
-rayfed_nightly-0.1.0b20230528.dev0.dist-info/RECORD,,
+rayfed_nightly-0.1.0b20230531.dev0.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
+rayfed_nightly-0.1.0b20230531.dev0.dist-info/METADATA,sha256=PUK_Tm9HK5uZZmxPogWKKebj6jmRLIGVKXzEsVyYlCs,7243
+rayfed_nightly-0.1.0b20230531.dev0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+rayfed_nightly-0.1.0b20230531.dev0.dist-info/top_level.txt,sha256=5gd1qhbpzLAi36ONV8p_s65_-iAiOSwFljYh-ONEwts,4
+rayfed_nightly-0.1.0b20230531.dev0.dist-info/RECORD,,
```

