# Comparing `tmp/doblib_legacy-0.16.3-py2-none-any.whl.zip` & `tmp/doblib_legacy-0.17.0-py2-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,20 +1,20 @@
-Zip file size: 24898 bytes, number of entries: 18
--rw-r--r--  2.0 unx       44 b- defN 23-May-30 06:40 doblib/__init__.py
--rw-r--r--  2.0 unx     5333 b- defN 23-May-30 06:41 doblib/__main__.py
--rw-r--r--  2.0 unx    17741 b- defN 23-May-30 06:41 doblib/action.py
--rw-r--r--  2.0 unx     4876 b- defN 23-May-30 06:41 doblib/aggregate.py
--rw-r--r--  2.0 unx      492 b- defN 23-May-30 06:41 doblib/base.py
--rw-r--r--  2.0 unx     5685 b- defN 23-May-30 06:41 doblib/ci.py
--rw-r--r--  2.0 unx     8939 b- defN 23-May-30 06:41 doblib/env.py
--rw-r--r--  2.0 unx     4021 b- defN 23-May-30 06:41 doblib/freeze.py
--rw-r--r--  2.0 unx     3431 b- defN 23-May-30 06:41 doblib/migrate.py
--rw-r--r--  2.0 unx    10377 b- defN 23-May-30 06:41 doblib/module.py
--rw-r--r--  2.0 unx     3316 b- defN 23-May-30 06:41 doblib/run.py
--rw-r--r--  2.0 unx     5584 b- defN 23-May-30 06:41 doblib/utils.py
--rw-r--r--  2.0 unx      551 b- defN 23-May-30 06:41 doblib_legacy-0.16.3.dist-info/LICENSE.md
--rw-r--r--  2.0 unx     1316 b- defN 23-May-30 06:41 doblib_legacy-0.16.3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-30 06:41 doblib_legacy-0.16.3.dist-info/WHEEL
--rw-r--r--  2.0 unx       46 b- defN 23-May-30 06:41 doblib_legacy-0.16.3.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        7 b- defN 23-May-30 06:41 doblib_legacy-0.16.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1394 b- defN 23-May-30 06:41 doblib_legacy-0.16.3.dist-info/RECORD
-18 files, 73245 bytes uncompressed, 22646 bytes compressed:  69.1%
+Zip file size: 24928 bytes, number of entries: 18
+-rw-r--r--  2.0 unx       44 b- defN 23-May-31 11:37 doblib/__init__.py
+-rw-r--r--  2.0 unx     5333 b- defN 23-May-31 11:38 doblib/__main__.py
+-rw-r--r--  2.0 unx    17995 b- defN 23-May-31 11:38 doblib/action.py
+-rw-r--r--  2.0 unx     4876 b- defN 23-May-31 11:38 doblib/aggregate.py
+-rw-r--r--  2.0 unx      492 b- defN 23-May-31 11:38 doblib/base.py
+-rw-r--r--  2.0 unx     5685 b- defN 23-May-31 11:38 doblib/ci.py
+-rw-r--r--  2.0 unx     8939 b- defN 23-May-31 11:38 doblib/env.py
+-rw-r--r--  2.0 unx     4025 b- defN 23-May-31 11:38 doblib/freeze.py
+-rw-r--r--  2.0 unx     3431 b- defN 23-May-31 11:38 doblib/migrate.py
+-rw-r--r--  2.0 unx    10377 b- defN 23-May-31 11:38 doblib/module.py
+-rw-r--r--  2.0 unx     3296 b- defN 23-May-31 11:38 doblib/run.py
+-rw-r--r--  2.0 unx     5584 b- defN 23-May-31 11:38 doblib/utils.py
+-rw-r--r--  2.0 unx      551 b- defN 23-May-31 11:39 doblib_legacy-0.17.0.dist-info/LICENSE.md
+-rw-r--r--  2.0 unx     1316 b- defN 23-May-31 11:39 doblib_legacy-0.17.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-31 11:39 doblib_legacy-0.17.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       46 b- defN 23-May-31 11:39 doblib_legacy-0.17.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        7 b- defN 23-May-31 11:39 doblib_legacy-0.17.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1394 b- defN 23-May-31 11:39 doblib_legacy-0.17.0.dist-info/RECORD
+18 files, 73483 bytes uncompressed, 22676 bytes compressed:  69.1%
```

## zipnote {}

```diff
@@ -30,26 +30,26 @@
 
 Filename: doblib/run.py
 Comment: 
 
 Filename: doblib/utils.py
 Comment: 
 
-Filename: doblib_legacy-0.16.3.dist-info/LICENSE.md
+Filename: doblib_legacy-0.17.0.dist-info/LICENSE.md
 Comment: 
 
-Filename: doblib_legacy-0.16.3.dist-info/METADATA
+Filename: doblib_legacy-0.17.0.dist-info/METADATA
 Comment: 
 
-Filename: doblib_legacy-0.16.3.dist-info/WHEEL
+Filename: doblib_legacy-0.17.0.dist-info/WHEEL
 Comment: 
 
-Filename: doblib_legacy-0.16.3.dist-info/entry_points.txt
+Filename: doblib_legacy-0.17.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: doblib_legacy-0.16.3.dist-info/top_level.txt
+Filename: doblib_legacy-0.17.0.dist-info/top_level.txt
 Comment: 
 
-Filename: doblib_legacy-0.16.3.dist-info/RECORD
+Filename: doblib_legacy-0.17.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## doblib/__init__.py

```diff
@@ -1,3 +1,3 @@
 # -*- coding: utf-8 -*-
 
-VERSION = "0.16.3"
+VERSION = "0.17.0"
```

## doblib/action.py

```diff
@@ -339,15 +339,15 @@
         for index in iterator:
             if isinstance(value[index], str):
                 if value[index] in replace_dict:
                     value[index] = replace_dict[value[index]]
             else:
                 self._replace_recursively(value[index], replace_dict)
 
-    def _action_delete(self, env, model, domain, item):
+    def _action_delete(self, env, model, domain, item, dry_run=False):
         """Runs the delete action"""
         if model not in env.registry:
             return
 
         references = item.get("references", {})
         chunk = item.get("chunk", None)
         truncate = item.get("truncate", False)
@@ -366,19 +366,20 @@
         self._replace_references(env, references, domain)
         records = env[model].with_context(active_test=False).search(domain)
 
         if records:
             if chunk:
                 for i in range(0, len(records), chunk):
                     records[i : i + chunk].unlink()
-                    env.cr.commit()
+                    if not dry_run:
+                        env.cr.commit()
             else:
                 records.unlink()
 
-    def _action_update(self, env, model, domain, item):
+    def _action_update(self, env, model, domain, item, dry_run=False):
         """Runs the update action"""
         values = item.get("values", {})
         if not values or model not in env.registry:
             return
 
         references = item.get("references", {})
         chunk = item.get("chunk", None)
@@ -402,15 +403,16 @@
                 const[name] = apply_act
 
         # Handle the constant values
         if const:
             if chunk:
                 for i in range(0, len(records), chunk):
                     records[i : i + chunk].write(const)
-                    env.cr.commit()
+                    if not dry_run:
+                        env.cr.commit()
             else:
                 records.write(const)
 
         # Handle the dynamic values
         if dynamic:
             counter = 0
             for rec in records:
@@ -419,17 +421,18 @@
                     vals[name] = self._apply(rec, name, **apply_act)
                 rec.write(vals)
 
                 counter += 1
 
                 if chunk and counter >= chunk:
                     counter = 0
-                    env.cr.commit()
+                    if not dry_run:
+                        env.cr.commit()
 
-    def _action_insert(self, env, model, domain, item):
+    def _action_insert(self, env, model, domain, item, dry_run=False):
         values = item.get("values", {})
         if not domain or not values or model not in env.registry:
             return
 
         if env[model].search(domain):
             return
 
@@ -462,15 +465,15 @@
         config.parse_config(["-c", base.ODOO_CONFIG])
         server.report_configuration()
 
         db_name = config["db_name"]
 
         utils.info("Running {}".format(args.action))
         with self._manage():
-            with self.env(db_name) as env:
+            with self.env(db_name, rollback=args.dry_run) as env:
                 for name, item in actions[args.action].items():
                     if not item.get("enable", True):
                         continue
 
                     steps = sum(args.steps, [])
 
                     if steps and name not in steps:
@@ -489,14 +492,14 @@
 
                     ctx = env.context.copy()
                     ctx.update(item.get("context") or {})
                     action_env = api.Environment(env.cr, env.uid, ctx)
 
                     act = item.get("action", "update")
                     if act == "update":
-                        self._action_update(action_env, model, domain, item)
+                        self._action_update(action_env, model, domain, item, dry_run=args.dry_run)
                     elif act == "delete":
-                        self._action_delete(action_env, model, domain, item)
+                        self._action_delete(action_env, model, domain, item, dry_run=args.dry_run)
                     elif act == "insert":
-                        self._action_insert(action_env, model, domain, item)
+                        self._action_insert(action_env, model, domain, item, dry_run=args.dry_run)
                     else:
                         utils.error("Undefined action {}".format(act))
```

## doblib/freeze.py

```diff
@@ -60,15 +60,15 @@
         if not os.path.isfile(file):
             return True
 
         if mode == "skip":
             return False
 
         if mode == "ask":
-            answer = input("Do you want to overwrite the {}? [y/N] ".format(file))
+            answer = raw_input("Do you want to overwrite the {}? [y/N] ".format(file))
             if answer.lower() != "y":
                 return False
 
         return True
 
     def _freeze_packages(self, file, mode="ask"):
         """Freeze the python packages in the versions.txt"""
```

## doblib/run.py

```diff
@@ -100,15 +100,14 @@
         debug_cmd = ()
         if debugger == "debugpy":
             utils.info("Starting with debugger %s", debugger)
             debug_cmd = "-m", "debugpy", "--listen", "0.0.0.0:5678", "--wait-for-client"
         elif debugger == "dev":
             args += ("--dev=all",)
 
-        print(path)
         if os.path.isfile(os.path.join(path, "odoo-bin")):
             cmd = ["odoo-bin", "-c", base.ODOO_CONFIG]
         else:
             cmd = ["openerp-server", "-c", base.ODOO_CONFIG]
 
         return utils.call(
             [sys.executable] + list(debug_cmd) + cmd + list(args),
```

## Comparing `doblib_legacy-0.16.3.dist-info/LICENSE.md` & `doblib_legacy-0.17.0.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `doblib_legacy-0.16.3.dist-info/METADATA` & `doblib_legacy-0.17.0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: doblib-legacy
-Version: 0.16.3
+Version: 0.17.0
 Summary: Management tool for Odoo installations
 Home-page: https://github.com/initos/dob-lib
 Author: initOS GmbH
 Author-email: info@initos.com
 License: Apache License 2.0
 Keywords: odoo environment management
 Platform: UNKNOWN
```

## Comparing `doblib_legacy-0.16.3.dist-info/RECORD` & `doblib_legacy-0.17.0.dist-info/RECORD`

 * *Files 13% similar despite different names*

```diff
@@ -1,18 +1,18 @@
-doblib/__init__.py,SHA256=HBn1IzYU2lcidg1k8l6QYayebL2Blu0HMz18Y40Mmq0,44
+doblib/__init__.py,SHA256=rFtbjvmd91Y5M8HQGLvVwAH7EzoXZtiRS6ousVwyiNs,44
 doblib/__main__.py,SHA256=squ2DP2uYe3Fm7NAO_P49oKR8M5h9o7n3NOHLO4xw7g,5333
-doblib/action.py,SHA256=tXIl81PPqmMS3m2BgSi6_4bqDNAvLXSXxBuPvfN6FMg,17741
+doblib/action.py,SHA256=w2kmeeExJ0CMS1HS98ZEnh28fDjgfWIIhN9kJ46MQ1M,17995
 doblib/aggregate.py,SHA256=gEfvLeuRPdi_v57AVRI3kwNj_aXyN8KrhjVzD0CEZ3Q,4876
 doblib/base.py,SHA256=xQbiebnOUBMN0BIR7RNuDfyP02pPcK_5ph-7xk3KiMk,492
 doblib/ci.py,SHA256=RmmQ9efv31upzyAqA9KDEj2JKAYKjq-0mSLko7A5r40,5685
 doblib/env.py,SHA256=G_DgoM4UdRmNy5Bs-H5uWPsYfs4j96thI9Z4TqYANP0,8939
-doblib/freeze.py,SHA256=LfP3EWF7iGldAvDui_C5QLcHAdrkH1pLXisuDyIAizw,4021
+doblib/freeze.py,SHA256=8HAPoP0TjbBIllmMaSVPE7P41bnlyb0FMlp5RukM3J4,4025
 doblib/migrate.py,SHA256=n2bohrjOVt_jvJsH3TKezIs2htOODHPaJed4tzzeUAg,3431
 doblib/module.py,SHA256=XiooZuOCdUPU4j6SSZAaimaBjDnOR1jPZRld_C8ApCE,10377
-doblib/run.py,SHA256=-v8G6VWrRAlMbEl6Y1OGVWWnYV6iqejvx_y1smrjqRc,3316
+doblib/run.py,SHA256=DoUgkYQFZz-n9iP8RZqQfq3qx9z-2-pqfWmtzkR6M4U,3296
 doblib/utils.py,SHA256=Cv5iv0QpXeDG4ymDqPxt7bvr1XSl8hxQDdGB6ropFao,5584
-doblib_legacy-0.16.3.dist-info/LICENSE.md,SHA256=dm1ol581xWfHbfHfIrsOk-yp4cKiCSawowwM4ouKI9M,551
-doblib_legacy-0.16.3.dist-info/METADATA,SHA256=RNkJZ2NlRIc32y0JnNQ1pBcUlCL-jZAH4zKb64fVBu8,1316
-doblib_legacy-0.16.3.dist-info/WHEEL,SHA256=1VPi6hfNQaRRNuEdK_3dv9o8COtLGnHWJghhj4CQ28k,92
-doblib_legacy-0.16.3.dist-info/entry_points.txt,SHA256=_6qfoLnNq30daSVlLayLNyP4hEw_aG22ko2N6A7tFzA,46
-doblib_legacy-0.16.3.dist-info/top_level.txt,SHA256=l6jb7tE-9AmzH88oMnRiO3KiYKD321UcGAHaiu3LbP4,7
-doblib_legacy-0.16.3.dist-info/RECORD,,
+doblib_legacy-0.17.0.dist-info/LICENSE.md,SHA256=dm1ol581xWfHbfHfIrsOk-yp4cKiCSawowwM4ouKI9M,551
+doblib_legacy-0.17.0.dist-info/METADATA,SHA256=SoclTJO4Ykq8_kOOljjTkLk5OjRmdpjRLsquzSNNdOQ,1316
+doblib_legacy-0.17.0.dist-info/WHEEL,SHA256=1VPi6hfNQaRRNuEdK_3dv9o8COtLGnHWJghhj4CQ28k,92
+doblib_legacy-0.17.0.dist-info/entry_points.txt,SHA256=_6qfoLnNq30daSVlLayLNyP4hEw_aG22ko2N6A7tFzA,46
+doblib_legacy-0.17.0.dist-info/top_level.txt,SHA256=l6jb7tE-9AmzH88oMnRiO3KiYKD321UcGAHaiu3LbP4,7
+doblib_legacy-0.17.0.dist-info/RECORD,,
```

